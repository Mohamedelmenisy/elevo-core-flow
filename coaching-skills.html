<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coaching Skills</title>
    <!-- Favicon Links -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://cdn-icons-png.flaticon.com/512/3281/3281289.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://cdn-icons-png.flaticon.com/512/3281/3281289.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://cdn-icons-png.flaticon.com/512/3281/3281289.png">
    <style>
        /* --- Global Styles --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        html { scroll-behavior: smooth; } /* Add smooth scrolling */

        body {
            margin: 0;
            padding: 0;
            line-height: 1.6;
            background-color: #f9f9f9;
            color: #333;
        }

        /* --- User Bar Styles (Consistent) --- */
        .user-bar {
            background-color: #34495e;
            padding: 10px 20px; /* Adjusted padding */
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            font-size: 14px; /* Adjusted font size */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px; /* Adjusted gap */
        }

        .user-info svg {
             opacity: 0.8;
        }

        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            font-size: 14px; /* Adjusted font size */
        }

        .user-email {
            font-size: 12px; /* Adjusted font size */
            opacity: 0.8;
        }

        .logout-button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px; /* Adjusted padding */
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease; /* Added ease */
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 13px; /* Adjusted font size */
        }

        .logout-button:hover {
            background-color: #c0392b;
            transform: translateY(-1px);
        }

        .logout-button:active {
            transform: translateY(0);
        }

        /* --- Navigation Tabs (Consistent) --- */
        .nav-tab {
            background-color: #2c3e50;
            padding: 12px 10px; /* Adjusted padding */
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            white-space: nowrap;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
            scrollbar-width: thin; /* Firefox scrollbar */
            scrollbar-color: #556a80 #2c3e50; /* Firefox scrollbar */
        }
        /* Webkit scrollbar styling */
        .nav-tab::-webkit-scrollbar { height: 6px; }
        .nav-tab::-webkit-scrollbar-track { background: #2c3e50; }
        .nav-tab::-webkit-scrollbar-thumb { background-color: #556a80; border-radius: 10px; border: 1px solid #2c3e50; }

        .nav-tab a {
            color: white;
            text-decoration: none;
            margin: 0 8px; /* Adjusted margin */
            padding: 8px 12px; /* Adjusted padding */
            border-radius: 6px; /* Adjusted radius */
            transition: background-color 0.3s, color 0.3s; /* Added color transition */
            font-size: 14px; /* Consistent font size */
            display: inline-block;
        }

        .nav-tab a:hover, .nav-tab a.active { /* Added active state style */
            background-color: #34495e;
            color: #fff; /* Ensure text remains white on hover/active */
        }

        /* --- Main Content Styles --- */
        h1 {
            color: #fff; /* Changed color to white for better contrast */
            background-color: #e67e22;
            padding: 20px; /* Increased padding */
            border-radius: 8px; /* Softer radius */
            text-align: center;
            margin: 25px auto; /* Adjusted margin */
            max-width: 800px;
            font-size: 26px; /* Adjusted size */
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); /* Added shadow */
        }

        h2 { /* Added styles for H2 consistency */
            color: #34495e; /* Darker blue-grey */
            margin-top: 35px;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid #ecf0f1; /* Light border bottom */
            font-size: 1.6em;
        }

        h3 { /* Added styles for H3 consistency */
             color: #e67e22; /* Orange color */
             margin-top: 20px;
             margin-bottom: 10px;
             font-size: 1.3em;
        }

        .container {
            max-width: 800px;
            margin: 20px auto 30px; /* Added bottom margin */
            background: white;
            padding: 30px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1); /* Slightly increased shadow */
            border-radius: 8px;
        }

        /* --- Content Blocks --- */
        .quote {
            font-style: italic;
            border-left: 4px solid #e67e22;
            padding: 15px 20px; /* Adjusted padding */
            background-color: #fdfaf6;
            margin: 25px 0; /* Consistent margin */
            border-radius: 0 6px 6px 0;
            font-size: 1.05em; /* Slightly larger quote text */
            color: #555; /* Darker grey text */
        }

        .quote p { margin-bottom: 10px; } /* Spacing within quote */
        .quote em { color: #c0392b; font-weight: 500; } /* Highlighted emphasis */

        .image-container {
            text-align: center;
            margin: 35px 0; /* More vertical space */
        }

        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.1); /* Slightly stronger shadow */
            border: 1px solid #eee; /* Subtle border */
        }
        .image-container p.caption { /* Added caption class */
            font-size: 0.9em;
            color: #666; /* Slightly lighter grey */
            margin-top: 12px;
            font-style: italic;
        }

        /* Tip/Action Boxes (Consistent) */
        .tip-box, .action-box {
            padding: 15px 20px;
            border-radius: 6px;
            margin: 25px 0; /* Consistent margin */
            color: #fff; /* White text */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border-left-width: 5px;
            border-left-style: solid;
        }
        .tip-box { background-color: #3498db; border-left-color: #2980b9; } /* Blue */
        .action-box { background-color: #e67e22; border-left-color: #d35400; } /* Orange */
        .tip-box strong, .action-box strong { display: block; margin-bottom: 8px; font-size: 1.1em; }


        /* Question Box Style (Consistent with Action Plan) */
        .question-box {
            background-color: rgba(52, 152, 219, 0.08); /* Light Blue BG */
            padding: 25px; border-radius: 6px; margin: 25px 0;
            border: 1px solid rgba(52, 152, 219, 0.2); /* Subtle Blue Border */
            border-left: 5px solid #3498db; /* Blue Accent */
        }
        .question-box h3 { /* Question Text */
             margin-top: 0; margin-bottom: 15px; /* More bottom margin */
             color: #34495e; /* Match user bar color */
             font-weight: 600; font-size: 1.2em; /* Adjusted size */
        }
         .question-box h3 .required-star { /* Style for asterisk */
             color: #e74c3c; font-weight: bold; margin-left: 3px;
         }
        .question-box p strong { /* Style for SWOT labels */
            color: #34495e; display: block; margin-top: 15px; margin-bottom: 5px; font-weight: 600;
        }


        /* --- Form Elements (Consistent) --- */
        textarea, input[type="text"] {
            width: 100%; padding: 12px; border: 1px solid #ddd;
            border-radius: 4px; margin-top: 8px; margin-bottom: 10px;
            background-color: #fff; min-height: 45px; line-height: 1.6;
            display: block; color: #333; font-size: 15px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        textarea { min-height: 80px; resize: vertical; }
        textarea:focus, input[type="text"]:focus {
            outline: none; border-color: #e67e22; /* Orange focus */
            box-shadow: 0 0 0 3px rgba(230, 126, 34, 0.2);
        }
        textarea::placeholder, input::placeholder { color: #aaa; opacity: 1; }

        /* --- Table Styles (Consistent) --- */
        table {
            width: 100%; border-collapse: collapse; margin: 25px 0;
            font-size: 14px; background-color: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05); border-radius: 6px; overflow: hidden; /* Clip corners */
        }
        table th, table td { border: 1px solid #eee; padding: 12px 15px; text-align: left; }
        table th { background-color: #f8f9fa; font-weight: 600; color: #34495e;}
        table tr:nth-child(even) td { background-color: #fdfdfd; } /* Subtle striping */

        .metaphor-table th { background-color: #3498db; color: white; text-align: center;} /* Blue header */
        .metaphor-table input[type="text"] { margin: 0; display: block; min-height: auto; padding: 10px; font-size: 14px;} /* Adjust input in table */
        .metaphor-table .button-group { margin-top: 5px; } /* Less space in table */

        /* Explicit thead/tbody usage recommended in HTML */
        table thead th { position: sticky; top: 50px; z-index: 1; } /* Make header sticky if nav is sticky */

        /* --- Buttons (Consistent) --- */
        .button-group {
            display: flex; align-items: center; flex-wrap: wrap; /* Allow wrapping */
            gap: 10px; /* Consistent gap */
            margin-top: 15px; /* Adjusted space */
        }

        .save-button, .delete-button {
            color: white; border: none; padding: 8px 15px; border-radius: 4px;
            cursor: pointer; transition: all 0.3s ease; font-size: 14px; font-weight: 500;
        }
        .save-button { background-color: #27ae60; } /* Green */
        .delete-button { background-color: #e74c3c; } /* Red */
        .save-button:hover { background-color: #2ecc71; transform: translateY(-1px); }
        .delete-button:hover { background-color: #c0392b; transform: translateY(-1px); }
        .save-button:active, .delete-button:active { transform: translateY(0); }

        .navigation-buttons {
            display: flex; justify-content: space-between; margin-top: 40px;
            gap: 20px; border-top: 1px solid #eee; padding-top: 25px;
        }
        .navigation-buttons a.nav-button { /* Use class for specificity */
            text-decoration: none; padding: 12px 20px; color: white; border-radius: 4px;
            font-weight: 600; flex: 1; text-align: center; transition: all 0.3s ease;
            font-size: 15px; border: none; cursor: pointer;
            background-color: #e67e22; /* Default orange */
        }
         .navigation-buttons a.nav-button.back { /* Style for back button */
             background-color: #6c757d; /* Grey */
         }
        .navigation-buttons a.nav-button:hover { transform: translateY(-1px); filter: brightness(110%); }
        .navigation-buttons a.nav-button:active { transform: translateY(0); filter: brightness(100%); }


        /* --- Feedback & Validation (Consistent) --- */
        .save-status {
            font-size: 13px; color: #27ae60; margin-left: 10px; display: none; font-weight: 500;
        }
        .save-status.deleted { color: #e74c3c; } /* Red for deleted */

        .error-message { /* Inline field error */
            color: #e74c3c; font-size: 13px; margin-left: 5px;
            display: none; font-weight: 500;
        }

        .required-field { /* Style for invalid input */
            border: 2px solid #e74c3c !important; background-color: #fff2f1 !important;
            box-shadow: 0 0 0 2px rgba(231, 76, 60, 0.2) !important; /* Subtle glow */
            /* animation: pulseBad 1s infinite alternate; */ /* Optional animation */
        }
        /* @keyframes pulseBad {
            from { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.4); }
            to { box-shadow: 0 0 0 6px rgba(231, 76, 60, 0); }
        } */

        .floating-warning { /* General page validation warning */
            background-color: #fff8e1; border-left: 4px solid #ffc107; padding: 15px 25px;
            color: #333; display: none; position: fixed; top: 75px; /* Adjust based on nav height */
            left: 50%; transform: translateX(-50%); z-index: 1001; border-radius: 6px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2); animation: slideDownFadeInWarn 0.4s ease-out;
            font-weight: 500; max-width: 90%; width: auto; min-width: 300px; text-align: center;
        }
        @keyframes slideDownFadeInWarn { from { opacity: 0; top: 50px; } to { opacity: 1; top: 75px; } }
        @keyframes fadeOutUpWarn { from { opacity: 1; top: 75px;} to { opacity: 0; top: 50px;} }

         /* Required Star Helper */
         .required-star { color: #e74c3c; font-weight: bold; margin-left: 2px; }

        /* --- Highlighted Sections --- */
        .highlight-section, .skills-list, .ei-elements, .trust-methods {
             padding: 20px; border-radius: 6px; margin: 25px 0; /* Consistent margin */
             border-left-width: 5px; border-left-style: solid;
             box-shadow: 0 2px 4px rgba(0,0,0,0.05); /* Subtle shadow */
        }
        .highlight-section { background-color: rgba(52, 152, 219, 0.08); border-left-color: #3498db;} /* Light Blue */
        .skills-list { background-color: rgba(46, 204, 113, 0.08); border-left-color: #2ecc71; } /* Light Green */
        .skills-list ul { margin-left: 25px; list-style: disc; padding-left: 15px; } /* Indent list */
        .ei-elements { background-color: rgba(155, 89, 182, 0.08); border-left-color: #9b59b6; } /* Light Purple */
        .ei-elements ol { margin-left: 25px; padding-left: 15px; } /* Indent list */
        .trust-methods { background-color: rgba(41, 128, 185, 0.08); border-left-color: #2980b9; } /* Darker Light Blue */
        .trust-methods ul { margin-left: 25px; list-style: disc; padding-left: 15px; } /* Indent list */

        /* Note paragraph style */
        .note {
            font-size: 0.9em; color: #555; margin-top: 15px; padding-left: 5px;
        }


        /* --- Responsive Adjustments (Consistent) --- */
        @media (max-width: 768px) {
             h1 { font-size: 22px; padding: 15px; margin: 20px 15px; }
             h2 { font-size: 1.4em; }
             h3 { font-size: 1.15em; }
             .container { padding: 20px; margin: 0 15px 20px; }
             .user-bar { padding: 10px 15px; font-size: 13px; }
             .user-name { font-size: 13px; }
             .user-email { font-size: 11px; }
             .logout-button { padding: 7px 12px; font-size: 12px; }
             .nav-tab { padding: 10px 5px; }
             .nav-tab a { margin: 0 5px; padding: 7px 10px; font-size: 13px;}
             .highlight-section, .question-box, .skills-list, .ei-elements, .trust-methods, .tip-box, .action-box { padding: 15px; margin: 20px 0; }
             textarea, input[type="text"] { padding: 10px; font-size: 14px; }
             textarea { min-height: 70px; }
             .save-button, .delete-button { padding: 7px 13px; font-size: 13px; }
             .navigation-buttons { flex-direction: column; gap: 15px; }
             .navigation-buttons a.nav-button { font-size: 14px; padding: 12px 15px;}
             .floating-warning { padding: 12px 20px; font-size: 14px; top: 65px; width: calc(100% - 30px); max-width: 400px; }
             @keyframes slideDownFadeInWarn { from { opacity: 0; top: 45px; } to { opacity: 1; top: 65px; } }
             @keyframes fadeOutUpWarn { from { opacity: 1; top: 65px;} to { opacity: 0; top: 45px;} }
             table, th, td { padding: 10px 8px; font-size: 13px; }
             .metaphor-table input[type="text"] { padding: 8px; font-size: 13px;}
        }

         @media (max-width: 480px) {
              h1 { font-size: 20px; }
              h2 { font-size: 1.3em; }
              h3 { font-size: 1.1em; }
              .container { padding: 15px; margin: 0 10px 15px; }
              .floating-warning { padding: 10px 15px; font-size: 13px; min-width: 260px; }
              table, th, td { font-size: 12px; padding: 8px 5px;}
              .metaphor-table input[type="text"] { font-size: 12px;}
              .button-group { gap: 8px; } /* Reduce gap slightly */
         }
    </style>
</head>
<body>
    <!-- User Info Bar -->
    <div class="user-bar">
        <div class="user-info">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <div class="user-details">
                <span class="user-name" id="userName">Welcome back</span> <!-- Default -->
                <span class="user-email" id="userEmail">user@example.com</span> <!-- Default -->
            </div>
        </div>
        <button class="logout-button" onclick="logout()">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            Logout
        </button>
    </div>

    <!-- Navigation Tabs -->
    <nav class="nav-tab">
        <a href="index.html">Home</a>
        <a href="article1.html">Article 1</a>
        <a href="coaching-skills.html" class="active">Coaching Skills</a> <!-- Set active -->
        <a href="coaching-individuals.html">Coaching Individuals</a>
        <a href="coaching-team.html">Team Coaching</a>
        <a href="coaching-yourself.html">Self Coaching</a>
        <a href="action-plan.html">Action Plan</a>
    </nav>

    <h1>1. Coaching Skills</h1>

    <!-- Floating Warning Message -->
    <div class="floating-warning" id="warningMessage">
        <!-- Content set by JS -->
    </div>

    <div class="container">
        <!-- Highlight Section -->
        <div class="highlight-section">
            <p>Feedback from people who have received coaching suggests that a coach's most important attributes are personal rapport, confidence, and a sense of humor.</p>
            <p>A report by the International Coaching Federation shows that thousands of coaching clients valued rapport and compatibility more highly than a coach's formal education, or his or her years of experience.</p>
            <p>This gives you an advantage – because, as a manager, you already have good working relationships with your team members.</p>
        </div>

        <!-- Skills List Section -->
        <div class="skills-list">
            <p>But coaching requires other important skills, too. These include:</p>
            <ul>
                <li>Listening</li>
                <li>Communicating</li>
                <li>Questioning</li>
                <li>Emotional intelligence</li>
                <li>Developing trust</li>
            </ul>
            <p>In this chapter, we'll look at these skills in more detail, and discuss how you can improve each one.</p>
        </div>

        <!-- Quote -->
        <div class="quote">
            <p>"A coach is someone who tells you what you don't want to hear, and has you see what you don't want to see, so you can be who you have always known you can be."</p>
            <p style="text-align: right;"><em>- Tom Landry</em></p> <!-- Added attribution -->
        </div>

        <!-- Image Container - Active Listening -->
        <div class="image-container">
             <img src="https://images.unsplash.com/photo-1517048676732-d65bc937f952?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80"
                 alt="Two colleagues actively listening and engaging in a coaching conversation in a modern office setting"
                 onerror="this.onerror=null; this.src='https://via.placeholder.com/800x450/3498db/ffffff?text=Active+Listening';">
            <p class="caption">Developing active listening skills is crucial for effective coaching.</p>
        </div>

        <h2>1.1. Improving Your Listening Skills</h2>

        <p>The ability to listen well is the most important coaching skill. It's key to understanding what the other person is saying on the surface, and to finding out what he or she means on a deeper level.</p>
        <p>Specifically, you need good <strong>active listening</strong> skills. This means giving your full attention, avoiding distractions (internal and external), and observing body language.</p>
        <p>Show you're listening with subtle cues (nodding, "Yes," "Uh huh") and by paraphrasing ("What I'm hearing is...").</p>
        <p><strong>Empathic listening</strong> goes further, aiming to understand emotions. Pay attention to tone, expressions, and what's *not* said.</p>
        <p><strong>Mindful listening</strong> involves listening without judgment, staying present and open to the speaker's message.</p>


        <div class="tip-box">
            <strong>TIP:</strong> Regularly assess your listening skills. Resources like self-tests or feedback can help identify areas for improvement.
        </div>

        <div class="action-box">
            <strong>ACTION:</strong> Practice active listening and reflect on the experience by answering the questions below.
        </div>

        <!-- Listening Question 1 -->
        <div class="question-box">
            <h3>Did the other person's body language align with what they said?<span class="required-star">*</span></h3>
            <textarea placeholder="Write your observations here..." class="required-answer" data-question="listen-q1"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('listen-q1', 'save-status-listen-q1', 'error-listen-q1')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('listen-q1', 'save-status-listen-q1', 'error-listen-q1')">Delete Answer</button>
                <span class="save-status" id="save-status-listen-q1"></span>
                <span class="error-message" id="error-listen-q1"></span>
            </div>
        </div>

         <!-- Listening Question 2 -->
        <div class="question-box">
            <h3>Did active listening help you understand the other person? If so, how?<span class="required-star">*</span></h3>
            <textarea placeholder="Explain how active listening impacted your understanding..." class="required-answer" data-question="listen-q2"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('listen-q2', 'save-status-listen-q2', 'error-listen-q2')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('listen-q2', 'save-status-listen-q2', 'error-listen-q2')">Delete Answer</button>
                <span class="save-status" id="save-status-listen-q2"></span>
                <span class="error-message" id="error-listen-q2"></span>
            </div>
        </div>

         <!-- Listening Question 3 -->
        <div class="question-box">
            <h3>How could active listening improve your relationships (personal and professional)?<span class="required-star">*</span></h3>
            <textarea placeholder="Reflect on the potential benefits..." class="required-answer" data-question="listen-q3"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('listen-q3', 'save-status-listen-q3', 'error-listen-q3')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('listen-q3', 'save-status-listen-q3', 'error-listen-q3')">Delete Answer</button>
                <span class="save-status" id="save-status-listen-q3"></span>
                <span class="error-message" id="error-listen-q3"></span>
            </div>
        </div>

        <h2>1.2. Developing Good Communication Skills</h2>

        <p>Effective coaches communicate thoughts and ideas clearly, ensuring the coachee understands without confusion. A key part is avoiding inserting your own opinions and assumptions.</p>

        <div class="image-container">
            <img src="https://images.unsplash.com/photo-1434030216411-0b793f4b4173?ixlib=rb-1.2.1&auto=format&fit=crop&w=1170&q=80"
                 alt="Two people communicating effectively, possibly planning or discussing work"
                 onerror="this.onerror=null; this.src='https://via.placeholder.com/800x450/e67e22/ffffff?text=Clear+Communication';">
            <p class="caption">Clear, objective communication is vital for successful coaching.</p>
        </div>

        <div class="quote">
            <p><strong>Example Scenario (with Assumptions):</strong></p>
            <p><strong>Rahma (Coach):</strong> So tell me what happened this week.</p>
            <p><strong>Mohamed (Coachee):</strong> I just couldn't find the time to read that leadership development book or work on the exercises.</p>
            <p><strong>Rahma:</strong> Was it your boss again? Did he add more to your workload? <em>(Assumption/Leading Question)</em></p>
            <p><strong>Mohamed:</strong> Yes, he did.</p>
            <p><strong>Rahma:</strong> That probably made you feel stressed and unappreciated, right? <em>(Assumption/Leading Question)</em></p>
            <p><strong>Mohamed:</strong> Yes, it doesn't make me feel good when he does that...</p>
        </div>

        <p>This example shows how easily assumptions influence conversations. Using <strong>Clean Language</strong> helps avoid this. Clean Language uses simple, neutral questions based on the coachee's *exact* words, particularly their metaphors, to explore their perspective without imposing your own.</p>

        <p>Pay close attention to the metaphors your coachee uses (e.g., "trapped," "build," "digest"), as they reveal deeper feelings and thought patterns. Explore these metaphors using Clean Language questions like:</p>
        <ul>
            <li>"And when you are [coachee's metaphor, e.g., 'trapped'], what kind of 'trapped' is that 'trapped'?"</li>
            <li>"And is there anything else about that [metaphor/word]?"</li>
            <li>"And where could [metaphor/word] come from?"</li>
            <li>"And what happens next?"</li>
        </ul>

        <div class="tip-box">
            <strong>TIP:</strong> Explore resources on Clean Language to master its core questions and application in coaching scenarios.
        </div>

        <div class="action-box">
            <strong>ACTION:</strong> For the next few days, pay attention to the metaphors *you* use in everyday speech. Write down at least 3 in the table below. Reflect on what they might reveal about your own perspective.
        </div>

        <!-- Metaphor Table -->
        <table class="metaphor-table">
            <thead>
                <tr>
                    <th>Metaphors You Use<span class="required-star">*</span> (Fill at least 3)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        <input type="text" class="required-answer" placeholder="Enter metaphor #1 here..." data-question="m1">
                        <div class="button-group">
                            <button class="save-button" onclick="saveAnswer('m1', 'save-status-m1', 'error-m1')">Save</button>
                            <button class="delete-button" onclick="deleteAnswer('m1', 'save-status-m1', 'error-m1')">Delete</button>
                            <span class="save-status" id="save-status-m1"></span>
                            <span class="error-message" id="error-m1"></span>
                        </div>
                    </td>
                </tr>
                 <tr>
                    <td>
                        <input type="text" class="required-answer" placeholder="Enter metaphor #2 here..." data-question="m2">
                        <div class="button-group">
                            <button class="save-button" onclick="saveAnswer('m2', 'save-status-m2', 'error-m2')">Save</button>
                            <button class="delete-button" onclick="deleteAnswer('m2', 'save-status-m2', 'error-m2')">Delete</button>
                            <span class="save-status" id="save-status-m2"></span>
                            <span class="error-message" id="error-m2"></span>
                        </div>
                    </td>
                </tr>
                 <tr>
                    <td>
                        <input type="text" class="required-answer" placeholder="Enter metaphor #3 here..." data-question="m3">
                        <div class="button-group">
                            <button class="save-button" onclick="saveAnswer('m3', 'save-status-m3', 'error-m3')">Save</button>
                            <button class="delete-button" onclick="deleteAnswer('m3', 'save-status-m3', 'error-m3')">Delete</button>
                            <span class="save-status" id="save-status-m3"></span>
                            <span class="error-message" id="error-m3"></span>
                        </div>
                    </td>
                </tr>
                 <!-- Optional Fields -->
                 <tr><td><input type="text" placeholder="Optional: Enter another metaphor..." data-question="m4"><div class="button-group"><button class="save-button" onclick="saveAnswer('m4', 'save-status-m4', 'error-m4')">Save</button><button class="delete-button" onclick="deleteAnswer('m4', 'save-status-m4', 'error-m4')">Delete</button><span class="save-status" id="save-status-m4"></span><span class="error-message" id="error-m4"></span></div></td></tr>
                 <tr><td><input type="text" placeholder="Optional: Enter another metaphor..." data-question="m5"><div class="button-group"><button class="save-button" onclick="saveAnswer('m5', 'save-status-m5', 'error-m5')">Save</button><button class="delete-button" onclick="deleteAnswer('m5', 'save-status-m5', 'error-m5')">Delete</button><span class="save-status" id="save-status-m5"></span><span class="error-message" id="error-m5"></span></div></td></tr>
                 <tr><td><input type="text" placeholder="Optional: Enter another metaphor..." data-question="m6"><div class="button-group"><button class="save-button" onclick="saveAnswer('m6', 'save-status-m6', 'error-m6')">Save</button><button class="delete-button" onclick="deleteAnswer('m6', 'save-status-m6', 'error-m6')">Delete</button><span class="save-status" id="save-status-m6"></span><span class="error-message" id="error-m6"></span></div></td></tr>
            </tbody>
        </table>
        <p class="note">Note: You need to enter at least 3 metaphors to satisfy the requirement marked with <span class="required-star">*</span> above.</p>


        <div class="action-box">
            <strong>ACTION:</strong> Practice the Clean Language technique in a conversation. Focus on identifying the other person's metaphors and using Clean Language questions (like those listed above) to explore their meaning without making assumptions. (No submission required here, just practice).
        </div>

        <h2>1.3. Asking Better Questions</h2>

        <p>Great coaches listen more than they talk. Ask <strong>open-ended questions</strong> (starting with "What?", "Why?", "How?", "Tell me about...") that require thoughtful answers, not just "Yes" or "No". Probe for more detail with follow-up questions like "Can you tell me more about that?" or "What makes you say that?". Crucially, allow adequate time for the coachee to think and respond – learn to be comfortable with silence, as it often precedes deeper insights.</p>

        <div class="tip-box">
            <strong>TIP:</strong> Techniques like the <strong>5 Whys</strong> can help uncover root causes. Explore resources on various questioning techniques (e.g., Socratic questioning, powerful questions) to expand your coaching toolkit.
        </div>

        <h2>1.4. Learning Emotional Intelligence</h2>

        <p><strong>Emotional intelligence (EI)</strong> is the ability to recognize, understand, and manage your own emotions, as well as recognize, understand, and influence the emotions of others. High EI leads to stronger relationships, better emotional control, and greater self-awareness – all vital for coaching.</p>

        <div class="ei-elements">
            <p><strong>The Five Key Elements of Emotional Intelligence:</strong></p>
            <ol>
                <li><strong>Self-Awareness:</strong> Knowing your emotions, strengths, weaknesses, values, and their impact.</li>
                <li><strong>Self-Regulation:</strong> Managing or redirecting disruptive impulses and moods; thinking before acting.</li>
                <li><strong>Motivation:</strong> Being driven to achieve for the sake of achievement, passion for work.</li>
                <li><strong>Empathy:</strong> Understanding others' emotional makeup; treating people according to their emotional reactions (crucial for coaching).</li>
                <li><strong>Social Skills:</strong> Proficiency in managing relationships and building networks; finding common ground.</li>
            </ol>
        </div>

        <div class="action-box">
            <strong>ACTION:</strong> Use the exercises below to increase your emotional intelligence. Answer the questions honestly.
        </div>

        <!-- EI Question 1 -->
        <div class="question-box">
            <h3>Think about your reactions in stressful situations. Do you tend to judge quickly or pause to gather facts? How could you improve your self-regulation in these moments?<span class="required-star">*</span></h3>
            <textarea placeholder="Reflect on your stress responses and potential improvements..." class="required-answer" data-question="eq1"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('eq1', 'save-status-eq1', 'error-eq1')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('eq1', 'save-status-eq1', 'error-eq1')">Delete Answer</button>
                <span class="save-status" id="save-status-eq1"></span>
                <span class="error-message" id="error-eq1"></span>
            </div>
        </div>

        <!-- EI Question 2 -->
        <div class="question-box">
            <h3>Recall a time you felt you lost emotional control (e.g., reacted impatiently, showed frustration) in a professional setting. What triggered it? What was the impact? How could you handle a similar situation differently using better self-awareness and self-regulation?<span class="required-star">*</span></h3>
            <textarea placeholder="Describe the situation, its effects, and future strategies..." class="required-answer" data-question="eq2"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('eq2', 'save-status-eq2', 'error-eq2')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('eq2', 'save-status-eq2', 'error-eq2')">Delete Answer</button>
                <span class="save-status" id="save-status-eq2"></span>
                <span class="error-message" id="error-eq2"></span>
            </div>
        </div>

        <!-- SWOT Analysis Questions -->
        <div class="question-box">
            <h3>Conduct a Personal SWOT Analysis focused on your Coaching Potential<span class="required-star">*</span></h3>
            <p><strong>Your Strengths:</strong> (What personal qualities or existing skills make you potentially a good coach?)</p>
            <textarea placeholder="List your key strengths relevant to coaching (e.g., patience, clarity, empathy, good listener)..." class="required-answer" data-question="swot-strengths"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('swot-strengths', 'save-status-swot-strengths', 'error-swot-strengths')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('swot-strengths', 'save-status-swot-strengths', 'error-swot-strengths')">Delete Answer</button>
                <span class="save-status" id="save-status-swot-strengths"></span>
                <span class="error-message" id="error-swot-strengths"></span>
            </div>

            <p><strong>How can you leverage these strengths in coaching conversations?</strong><span class="required-star">*</span></p>
            <textarea placeholder="Explain how you'll consciously use your strengths..." class="required-answer" data-question="swot-ideas"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('swot-ideas', 'save-status-swot-ideas', 'error-swot-ideas')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('swot-ideas', 'save-status-swot-ideas', 'error-swot-ideas')">Delete Answer</button>
                <span class="save-status" id="save-status-swot-ideas"></span>
                <span class="error-message" id="error-swot-ideas"></span>
            </div>

            <p><strong>Your Weaknesses:</strong> (What aspects of your personality or habits might hinder your coaching effectiveness?)</p>
            <textarea placeholder="Identify areas for improvement (e.g., interrupting, impatience, difficulty staying neutral, avoiding difficult topics)..." class="required-answer" data-question="swot-weaknesses"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('swot-weaknesses', 'save-status-swot-weaknesses', 'error-swot-weaknesses')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('swot-weaknesses', 'save-status-swot-weaknesses', 'error-swot-weaknesses')">Delete Answer</button>
                <span class="save-status" id="save-status-swot-weaknesses"></span>
                <span class="error-message" id="error-swot-weaknesses"></span>
            </div>

            <p><strong>How might these weaknesses affect coaching? What specific steps can you take to mitigate or improve them?</strong><span class="required-star">*</span></p>
            <textarea placeholder="Analyze the impact and plan improvement steps..." class="required-answer" data-question="swot-thoughts"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('swot-thoughts', 'save-status-swot-thoughts', 'error-swot-thoughts')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('swot-thoughts', 'save-status-swot-thoughts', 'error-swot-thoughts')">Delete Answer</button>
                <span class="save-status" id="save-status-swot-thoughts"></span>
                <span class="error-message" id="error-swot-thoughts"></span>
            </div>
        </div>

        <h2>1.5. Building Trust</h2>

        <p>Trust and confidentiality are the absolute cornerstones of effective coaching. Without trust, coachees will not feel safe enough to share openly, explore vulnerabilities, or commit to change.</p>

        <div class="trust-methods">
            <p><strong>Key Ways to Build and Maintain Trust:</strong></p>
            <ul>
                <li><strong>Be Honest and Transparent:</strong> Consistently tell the truth, even when difficult. Be clear about the coaching process and boundaries.</li>
                <li><strong>Maintain Confidentiality:</strong> Strictly adhere to confidentiality agreements. What's said in coaching stays in coaching (unless legally required otherwise, which should be stated upfront).</li>
                <li><strong>Show Genuine Care and Respect:</strong> Demonstrate empathy, listen non-judgmentally, and value the coachee's perspective.</li>
                <li><strong>Be Reliable and Consistent:</strong> Keep appointments, follow through on commitments, and maintain a consistent coaching approach.</li>
                <li><strong>Share Appropriately (Vulnerability):</strong> Relating relevant personal experiences (mistakes learned from, values) *judiciously* can build rapport, but avoid making it about you.</li>
                <li><strong>Demonstrate Competence:</strong> Use your coaching skills effectively and show you understand the process.</li>
                <li><strong>Uphold Ethical Standards:</strong> Act with integrity, fairness, and respect at all times.</li>
            </ul>
        </div>

        <div class="tip-box">
            <strong>TIP:</strong> View difficult conversations not as confrontations, but as opportunities for a <em>"Savvy Conversation"</em> – be candid and direct while maintaining respect, seeking understanding, and focusing on positive outcomes. Trust is often built, not broken, in how challenging topics are handled.
        </div>

        <div class="action-box">
            <strong>ACTION:</strong> Consider committing to daily journaling for a period (e.g., a month) to enhance self-awareness. Record daily events and, importantly, reflect on your associated feelings, reactions, and underlying assumptions. (No submission required).
        </div>

        <div class="action-box">
            <strong>ACTION:</strong> Reflect on this chapter's topics and answer the final questions below.
        </div>

        <!-- Final Question 1 -->
        <div class="question-box">
            <h3>Which coaching skill (listening, communicating, questioning, EI, trust-building) do you anticipate being the most challenging for you to apply consistently? Why?<span class="required-star">*</span></h3>
            <textarea placeholder="Identify your biggest challenge and explain the reasons..." class="required-answer" data-question="final-q1"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('final-q1', 'save-status-final-q1', 'error-final-q1')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('final-q1', 'save-status-final-q1', 'error-final-q1')">Delete Answer</button>
                <span class="save-status" id="save-status-final-q1"></span>
                <span class="error-message" id="error-final-q1"></span>
            </div>
        </div>

        <!-- Final Question 2 -->
        <div class="question-box">
            <h3>Based on your reflections in this chapter (including your SWOT), what are 1-2 specific, actionable steps you will take *this week* to begin improving in that challenging area?<span class="required-star">*</span></h3>
            <textarea placeholder="Outline concrete, measurable steps for improvement (e.g., 'Practice paraphrasing twice in my next team meeting', 'Read one article on handling difficult emotions')..." class="required-answer" data-question="final-q2"></textarea>
            <div class="button-group">
                <button class="save-button" onclick="saveAnswer('final-q2', 'save-status-final-q2', 'error-final-q2')">Save Answer</button>
                <button class="delete-button" onclick="deleteAnswer('final-q2', 'save-status-final-q2', 'error-final-q2')">Delete Answer</button>
                <span class="save-status" id="save-status-final-q2"></span>
                <span class="error-message" id="error-final-q2"></span>
            </div>
        </div>
         <p class="note">Note: Fields marked with <span class="required-star">*</span> are required to proceed to the next section.</p>

        <h2>1.6. Drawing This Together</h2>

        <p>In this chapter, we explored the essential skills underpinning effective coaching: active, empathic, and mindful listening; clear, assumption-free communication using techniques like Clean Language; powerful, open-ended questioning; the components of emotional intelligence (self-awareness, self-regulation, motivation, empathy, social skills); and the critical importance of building and maintaining trust.</p>
        <p>Mastering these skills forms the foundation for creating positive, productive, and transformational coaching relationships.</p>

        <div class="image-container">
            <img src="https://images.unsplash.com/photo-1552664730-d307ca884978?ixlib=rb-1.2.1&auto=format&fit=crop&w=1170&q=80"
                 alt="Coach and coachee collaborating at a whiteboard, symbolizing the coaching process and relationship"
                 onerror="this.onerror=null; this.src='https://via.placeholder.com/800x450/27ae60/ffffff?text=Coaching+Relationship+and+Process';">
            <p class="caption">Building strong coaching relationships through trust and effective skills application leads to a successful coaching process.</p>
        </div>

        <!-- Navigation -->
        <div class="navigation-buttons">
            <a href="article1.html" class="nav-button back">← Back to Article 1</a> <!-- Added 'back' class -->
            <a href="coaching-individuals.html" class="nav-button" id="nextButton">Next: Coaching Individuals →</a>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const formspreeEndpoint = 'https://formspree.io/f/xzzeqvea'; // Your Formspree Endpoint URL
        const localStorageKey = 'allUserAnswers_coachingSkills'; // Specific key for THIS page's answers
        const currentUserKey = 'currentUser'; // Key for storing the whole user object

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', function() {
             // --- 1. Basic Login Check ---
             if (localStorage.getItem('loggedIn') !== 'true') {
                 console.log("Not logged in, redirecting...");
                 window.location.href = `login.html?redirect=${encodeURIComponent(window.location.pathname + window.location.search)}`; // Include query params if any
                 return;
             }

             // --- 2. Get User Data ---
             const currentUser = getCurrentUser();

             // --- 3. Display User Info (Handles defaults internally) ---
             displayUserInfo(); // Reads from localStorage

             // --- 4. Validate User Session ---
             if (!currentUser || !currentUser.email) {
                 console.error("User session invalid or email missing after login check. Logging out...");
                 alert('Your session data seems corrupted. Please log in again.');
                 logout(); // Force logout and redirect
                 return;
             }

             // --- 5. Proceed with Page Setup ---
             const userEmail = currentUser.email;
             console.log("User is valid:", userEmail, "- Proceeding with page setup.");
             loadUserAnswers(userEmail);
             setupEventListeners(userEmail);
             highlightActiveNav(); // Highlight current nav tab
             // markRequiredQuestions(); // Add visual markers (optional, done via CSS/HTML mostly now)
        });

        // --- User Info & Authentication ---
        function getCurrentUser() {
             // Re-usable function to get and parse user data safely
             try {
                 const data = localStorage.getItem(currentUserKey);
                 if (data) {
                     const parsedData = JSON.parse(data);
                     // Basic validation: ensure it's an object with at least an email
                     if (parsedData && typeof parsedData === 'object' && parsedData.email) {
                         return parsedData;
                     } else {
                         console.warn("currentUser data found but invalid or missing email.", parsedData);
                         localStorage.removeItem(currentUserKey); // Clean up invalid data
                         localStorage.removeItem('loggedIn'); // Force logout
                         return null;
                     }
                 }
                 return null; // No data found
             } catch (e) {
                 console.error("Error parsing currentUser data:", e);
                  localStorage.removeItem(currentUserKey); // Clean up corrupted data
                  localStorage.removeItem('loggedIn'); // Force logout
                 return null;
             }
        }

        function displayUserInfo() {
            // Reads directly from localStorage - Consistent pattern
            const userNameElement = document.getElementById('userName');
            const userEmailElement = document.getElementById('userEmail');
            let userName = 'User'; // Default
            let userEmail = 'user@example.com'; // Default

            try {
                const userDataString = localStorage.getItem(currentUserKey);
                if (userDataString) {
                    const userData = JSON.parse(userDataString);
                    userName = userData.name || userName; // Use stored name or default
                    userEmail = userData.email || userEmail; // Use stored email or default
                }
            } catch (error) {
                console.error("Error displaying user info:", error);
                 // Keep defaults if error occurs
            }

            if (userNameElement) userNameElement.textContent = `Welcome, ${userName}`;
            if (userEmailElement) userEmailElement.textContent = userEmail;
        }

        function logout() {
            console.log("Logging out...");
            localStorage.removeItem('loggedIn');
            localStorage.removeItem(currentUserKey);
            // No need to remove userEmailKey if currentUserKey is the standard
            // localStorage.removeItem(userEmailKey);

            // Decide if page-specific answers should be cleared on logout
            // localStorage.removeItem(localStorageKey); // Uncomment to clear page answers on logout

            window.location.href = 'login.html';
        }

        function highlightActiveNav() {
             const currentPath = window.location.pathname.split('/').pop() || 'index.html';
             document.querySelectorAll('.nav-tab a').forEach(link => {
                 const linkPath = (link.getAttribute('href') || '').split('/').pop();
                 link.classList.toggle('active', linkPath === currentPath);
             });
         }

        // Optional: Function to add asterisks dynamically if not done in HTML
        // function markRequiredQuestions() { ... } // Can be added if needed

        // --- Answer Handling (Local Storage) ---
        function loadUserAnswers(userEmail) {
            if (!userEmail) { console.warn("loadUserAnswers: No userEmail provided."); return; }
            console.log("Loading answers for:", userEmail);
            let allAnswers = {};
            try {
                 const storedAnswers = localStorage.getItem(localStorageKey);
                 if (storedAnswers) {
                     allAnswers = JSON.parse(storedAnswers) || {};
                 }
            } catch (e) {
                 console.error("Error parsing user answers from localStorage:", e);
                 allAnswers = {}; // Reset on error to prevent further issues
            }

            const userAnswers = allAnswers[userEmail] || {};
            console.log("Found answers:", userAnswers);

            document.querySelectorAll('.required-answer, input[type="text"][data-question]').forEach(field => {
                const questionId = field.getAttribute('data-question');
                if (!questionId) return; // Skip elements without data-question

                const statusId = `save-status-${questionId}`;
                const statusElement = document.getElementById(statusId);
                const errorId = `error-${questionId}`;
                const errorElement = document.getElementById(errorId);

                // Reset states
                field.classList.remove('required-field');
                if (statusElement) statusElement.style.display = 'none';
                if (errorElement) errorElement.style.display = 'none';

                // Load value if exists
                if (userAnswers[questionId] !== undefined && userAnswers[questionId] !== null) {
                    field.value = userAnswers[questionId];
                    // Optional: Show saved status briefly only on initial load
                    // if (String(userAnswers[questionId]).trim() !== '' && statusElement) {
                    //     statusElement.textContent = '✓ Loaded'; // Indicate loaded state
                    //     statusElement.style.color = '#6c757d'; // Grey for loaded
                    //     statusElement.style.display = 'inline';
                    //     setTimeout(() => { statusElement.style.display = 'none'; }, 2000);
                    // }
                } else {
                    field.value = ''; // Ensure field is clear if no answer stored
                }
            });
        }

        function saveAnswerToStorage(userEmail, questionId, answer) {
             if (!userEmail) { console.error("saveAnswerToStorage: No userEmail!"); return false; }
             let allAnswers = {};
             try {
                 const storedAnswers = localStorage.getItem(localStorageKey);
                 if (storedAnswers) {
                     allAnswers = JSON.parse(storedAnswers) || {};
                 }
             } catch (e) {
                 console.error("Error parsing answers before saving:", e);
                 alert("Could not load previous answers due to data error. Your new answer might overwrite others.");
                 allAnswers = {}; // Reset if corrupted to avoid spreading error
             }

            if (!allAnswers[userEmail]) {
                allAnswers[userEmail] = {};
            }
            allAnswers[userEmail][questionId] = answer;

            try {
                localStorage.setItem(localStorageKey, JSON.stringify(allAnswers));
                console.log(`Saved: ${userEmail} -> ${localStorageKey} -> ${questionId}`);
                return true;
            } catch (e) {
                 console.error("Error saving answers to localStorage:", e);
                 alert("Failed to save your answer. Local storage might be full or disabled.");
                 return false;
            }
        }

         function deleteAnswerFromStorage(userEmail, questionId) {
             if (!userEmail) { console.error("deleteAnswerFromStorage: No userEmail!"); return false; }
             let allAnswers = {};
             try {
                 const storedAnswers = localStorage.getItem(localStorageKey);
                 if (storedAnswers) {
                     allAnswers = JSON.parse(storedAnswers) || {};
                 } else {
                     return false; // Nothing to delete from
                 }
             } catch (e) {
                 console.error("Error parsing answers before deletion:", e);
                 alert("Could not load answers to perform deletion due to data error.");
                 return false; // Abort deletion if data is corrupted
             }

             let updated = false;
             if (allAnswers[userEmail] && allAnswers[userEmail][questionId] !== undefined) {
                delete allAnswers[userEmail][questionId];
                updated = true;
                console.log(`Deleted: ${userEmail} -> ${localStorageKey} -> ${questionId}`);
                // Optional: remove user entry if no answers left
                if (Object.keys(allAnswers[userEmail]).length === 0) {
                    delete allAnswers[userEmail];
                     console.log(`Removed empty user entry ${userEmail} from ${localStorageKey}`);
                }
            }

             if (updated) {
                 try {
                     localStorage.setItem(localStorageKey, JSON.stringify(allAnswers));
                     return true;
                 } catch (e) {
                     console.error("Error saving after deletion:", e);
                     // State might be inconsistent now
                     return false;
                 }
             }
             return false; // Nothing was deleted
        }

        // --- Event Listeners Setup ---
        function setupEventListeners(userEmail) {
            if (!userEmail) { console.warn("setupEventListeners: No userEmail."); return; }

            // Auto-remove required styling on input/change
            document.querySelectorAll('.required-answer, input[type="text"][data-question]').forEach(field => {
               const eventType = (field.tagName === 'TEXTAREA' || field.type === 'text') ? 'input' : 'change';
               field.addEventListener(eventType, function() {
                   const questionId = this.getAttribute('data-question');
                   const errorId = `error-${questionId}`;
                   hideError(errorId); // Hide specific error message
                   this.classList.remove('required-field'); // Remove red border

                   // If it's a metaphor field, re-check the group validation silently
                   if (questionId && questionId.startsWith('m')) {
                       checkMetaphorGroupSilently();
                   }
               });
            });

           // Next button validation
           const nextButton = document.getElementById('nextButton');
           if (nextButton) {
               nextButton.addEventListener('click', function(e) {
                   console.log("Next button clicked. Validating...");
                   if (!validateAllAnswers(true)) { // Pass true to show errors
                       e.preventDefault(); // Stop navigation
                       showWarningMessage("Please complete all required fields marked with * before proceeding.");
                       console.log("Validation failed. Navigation stopped.");
                   } else {
                       console.log("Validation passed. Proceeding to next page.");
                       // Allow default navigation
                   }
               });
           } else {
               console.warn("Next button not found.");
           }
       }

        // --- UI Feedback & Validation ---
        function validateAllAnswers(showErrors = false) {
            let allValid = true;
            let firstInvalidField = null;
            console.log(`Running validation (Show Errors: ${showErrors})`);

            // 1. Check all non-metaphor required fields
            document.querySelectorAll('.required-answer:not([data-question^="m"])').forEach(field => {
                 const questionId = field.getAttribute('data-question');
                 const errorId = `error-${questionId}`;
                 // Reset first
                 hideError(errorId);
                 field.classList.remove('required-field');

                 if (field.value.trim() === '') {
                     allValid = false;
                     console.log(`Validation fail: ${questionId} is empty.`);
                     if (showErrors) {
                         showError(errorId, field, 'This field is required.');
                     }
                     if (!firstInvalidField) firstInvalidField = field;
                 }
            });

             // 2. Check metaphor fields count
             let metaphorCount = 0;
             const metaphorFields = document.querySelectorAll('input[data-question^="m"]'); // Select all metaphor inputs
             metaphorFields.forEach(field => {
                 if (field.value.trim() !== '') {
                     metaphorCount++;
                 }
             });

             const requiredMetaphorCount = 3;
             if (metaphorCount < requiredMetaphorCount) {
                 allValid = false;
                 console.log(`Validation fail: Metaphor count is ${metaphorCount}, required ${requiredMetaphorCount}.`);
                 if (showErrors) {
                     // Highlight only the *required* ones (m1, m2, m3) if count is low
                     document.querySelectorAll('.required-answer[data-question^="m"]').forEach(field => {
                         const questionId = field.getAttribute('data-question');
                         const errorId = `error-${questionId}`;
                         showError(errorId, field, `Please enter at least ${requiredMetaphorCount} metaphors.`);
                          if (!firstInvalidField) firstInvalidField = field; // Track the first required empty metaphor field
                     });
                 }
             } else {
                  // Clear errors from required metaphor fields if count is met
                 document.querySelectorAll('.required-answer[data-question^="m"]').forEach(field => {
                     const questionId = field.getAttribute('data-question');
                     const errorId = `error-${questionId}`;
                     hideError(errorId);
                     // Only remove red border if the specific field is also filled
                     if (field.value.trim() !== '') {
                          field.classList.remove('required-field');
                     }
                 });
             }

            // 3. Scroll to first error if validation failed
            if (!allValid && showErrors && firstInvalidField) {
                console.log("Scrolling to first invalid field:", firstInvalidField.dataset.question);
                firstInvalidField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                setTimeout(() => { try { firstInvalidField.focus({ preventScroll: true }); } catch (e) {} }, 300);
            }

            console.log("Validation overall result:", allValid);
            return allValid;
        }

         // Helper to silently check metaphor count and clear group error if met
         function checkMetaphorGroupSilently() {
             let metaphorCount = 0;
             document.querySelectorAll('input[data-question^="m"]').forEach(field => {
                 if (field.value.trim() !== '') {
                     metaphorCount++;
                 }
             });
             if (metaphorCount >= 3) {
                 document.querySelectorAll('.required-answer[data-question^="m"]').forEach(field => {
                     const errorId = `error-${field.getAttribute('data-question')}`;
                     hideError(errorId);
                     // Remove border only if individually filled
                     if (field.value.trim() !== '') {
                         field.classList.remove('required-field');
                     }
                 });
             }
         }


        function showWarningMessage(message = "Please complete all required fields marked with *.") {
            const warningElement = document.getElementById('warningMessage');
            if (!warningElement) return;

            warningElement.innerHTML = `<strong>Action Required:</strong> ${message}`; // Use innerHTML to render span if needed
            warningElement.style.animation = 'none'; // Reset animation
            void warningElement.offsetWidth; // Trigger reflow
            warningElement.style.display = 'block';
            warningElement.style.animation = 'slideDownFadeInWarn 0.4s ease-out';

            // Clear previous timer if exists
            clearTimeout(warningElement.timer);

            // Set new timer to hide the message
            warningElement.timer = setTimeout(() => {
                warningElement.style.animation = 'fadeOutUpWarn 0.5s ease-out forwards';
                setTimeout(() => {
                    if (warningElement.style.animationName === 'fadeOutUpWarn') {
                        warningElement.style.display = 'none';
                        warningElement.style.animation = '';
                    }
                }, 500); // Matches animation duration
            }, 4000); // Display duration
        }

        function showSaveStatus(statusId, message = '✓ Saved') {
             const statusElement = document.getElementById(statusId);
             if (!statusElement) return;
             statusElement.textContent = message;
             statusElement.classList.remove('deleted'); // Ensure it's not styled as deleted unless specified
             statusElement.style.color = '#27ae60'; // Default green

             if (message.toLowerCase().includes('delete')) {
                 statusElement.classList.add('deleted'); // Add class for potential specific styling
                 statusElement.style.color = '#e74c3c'; // Red for deleted confirmation
             }

             statusElement.style.display = 'inline-block';
             clearTimeout(statusElement.timer); // Clear previous timer
             statusElement.timer = setTimeout(() => {
                 statusElement.style.display = 'none';
             }, 3000);
        }

        function showError(errorId, field, message = 'This field is required.') {
             const errorElement = document.getElementById(errorId);
             if (errorElement) {
                 errorElement.textContent = message;
                 errorElement.style.display = 'inline-block'; // Show error message
             }
             if (field) {
                  field.classList.add('required-field'); // Add red border
             }
        }

        function hideError(errorId) {
             const errorElement = document.getElementById(errorId);
             if (errorElement) errorElement.style.display = 'none';
             // Note: We don't remove 'required-field' class here, only on input or successful validation
        }

        function hideMessages(statusId, errorId, field) {
            // Utility to hide status and error for a field
             const statusElement = document.getElementById(statusId);
             const errorElement = document.getElementById(errorId);
             if (statusElement) statusElement.style.display = 'none';
             if (errorElement) errorElement.style.display = 'none';
             if (field) field.classList.remove('required-field'); // Remove validation style
        }


        // --- Actions (Save, Delete) - Make available globally for onclick ---
        window.saveAnswer = function(questionId, statusId, errorId) {
            const currentUser = getCurrentUser();
            if (!currentUser || !currentUser.email) {
                alert('Session expired. Please login again.');
                logout();
                return;
            }
            const userEmail = currentUser.email;

            const field = document.querySelector(`[data-question="${questionId}"]`);
            if (!field) { console.error(`Field not found: ${questionId}`); return; }

            const answer = field.value; // Get current value
            const isRequired = field.classList.contains('required-answer');

            // --- Basic Validation ---
            hideMessages(statusId, errorId, field); // Clear previous state

            // 1. Check if required field is empty
            if (isRequired && answer.trim() === '') {
                showError(errorId, field, 'This field is required.');
                return; // Don't save empty required field
            }

             // 2. Check metaphor group requirement if applicable
             let isMetaphorField = questionId.startsWith('m');
             if (isMetaphorField) {
                  let metaphorCount = 0;
                  document.querySelectorAll('input[data-question^="m"]').forEach(mf => {
                      if (mf.value.trim() !== '') metaphorCount++;
                  });
                  if (metaphorCount < 3) {
                      // Don't necessarily show an error *here* unless this save *fails* the group,
                      // but maybe prevent saving optional empty ones if count is below 3?
                      // For simplicity, we'll allow saving individual ones, validation handles the group check on 'Next'.
                  } else {
                       // If count is now >= 3, clear any lingering group errors
                       checkMetaphorGroupSilently();
                  }
             }


            // --- Save and Submit ---
            // 1. Save to Local Storage
            if (saveAnswerToStorage(userEmail, questionId, answer)) {
                 // 2. Send to Formspree (only if saved locally successfully)
                 submitToFormspree(userEmail, questionId, answer);
                 // 3. Show confirmation
                 showSaveStatus(statusId, '✓ Saved');
            } else {
                 // Show save error status if localStorage failed
                 showSaveStatus(statusId, '✗ Save Error');
            }
        }

        window.deleteAnswer = function(questionId, statusId, errorId) {
             const currentUser = getCurrentUser();
             if (!currentUser || !currentUser.email) {
                 alert('Session expired. Please login again.');
                 logout();
                 return;
             }
             const userEmail = currentUser.email;

            const field = document.querySelector(`[data-question="${questionId}"]`);
            if (!field) { console.error(`Field not found: ${questionId}`); return; }
            const isRequired = field.classList.contains('required-answer');

            hideMessages(statusId, errorId, field); // Hide previous state

            // Clear the field value
            field.value = '';

            // Remove from Local Storage
            if (deleteAnswerFromStorage(userEmail, questionId)) {
                 showSaveStatus(statusId, '✓ Answer Deleted');
                 // Re-apply required styles if needed
                 if (isRequired) {
                      field.classList.add('required-field'); // Mark as required again since it's empty
                      // If it's a metaphor field, re-check group status
                      if (questionId.startsWith('m')) {
                           validateAllAnswers(true); // Re-run validation to show group error if needed
                      }
                 }
            } else {
                 showSaveStatus(statusId, '✗ Delete Error'); // Indicate if deletion failed
            }
        }

        // --- Formspree Submission ---
        function submitToFormspree(userEmail, questionId, answer) {
            // Submit even if answer is whitespace, let backend handle if needed
            if (!formspreeEndpoint) { console.warn("Formspree endpoint not configured."); return; }
            if (!userEmail) { console.warn("Formspree: No userEmail provided."); return; }

            const formData = new FormData();
            formData.append('email', userEmail);
            formData.append('page_title', document.title);
            formData.append('page_key', 'coachingSkills'); // Specific key for this page
            formData.append('question_id', questionId);
            formData.append('answer_text', answer);

            const currentUser = getCurrentUser();
             if (currentUser?.name) formData.append('user_name', currentUser.name);

            // Add question context
             let context = `Q-ID: ${questionId}`; // Fallback
             const fieldElement = document.querySelector(`[data-question="${questionId}"]`);
             if (fieldElement) {
                 let headingElement = null;
                 const questionBox = fieldElement.closest('.question-box');
                 const table = fieldElement.closest('.metaphor-table');

                 if (questionBox) { // Standard question box
                      headingElement = questionBox.querySelector('h3');
                     // Handle SWOT structure where P precedes textarea
                     if (!headingElement) {
                          const pLabel = fieldElement.previousElementSibling;
                          if (pLabel && pLabel.tagName === 'P') { headingElement = pLabel; }
                     }
                 } else if (table) { // Metaphor table
                     headingElement = table.querySelector('th'); // Get table header
                     context = headingElement ? `${headingElement.textContent.trim()} (#${questionId.substring(1)})` : `Metaphor Entry (#${questionId.substring(1)})`;
                     headingElement = null; // Prevent using table header text directly below
                 }

                 if (headingElement) {
                      context = headingElement.textContent.replace(/<span class="required-star">\*<\/span>/gi, '').trim(); // Remove star span/text
                 }
             }
            formData.append('question_context', context);


            fetch(formspreeEndpoint, {
                method: 'POST',
                body: formData,
                headers: { 'Accept': 'application/json' }
            })
            .then(response => {
                if (response.ok) {
                    console.log(`Formspree: ${questionId} (Page: ${document.title}) submitted.`);
                } else {
                     response.json().then(data => {
                        const errorMsg = data?.errors ? data.errors.map(e => e.message || e.code).join(', ') : `Status: ${response.status}`;
                        console.error(`Formspree error (${questionId}, ${document.title}): ${errorMsg}`);
                    }).catch(() => {
                        console.error(`Formspree non-JSON error (${questionId}, ${document.title}). Status: ${response.status} ${response.statusText}`);
                    });
                }
            })
            .catch(error => {
                console.error(`Network error submitting (${questionId}, ${document.title}) to Formspree:`, error);
            });
        }

    </script>
</body>
</html>
