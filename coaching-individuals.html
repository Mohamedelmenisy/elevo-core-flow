<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coaching Individuals</title>
    <!-- Favicon Links -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://cdn-icons-png.flaticon.com/512/3281/3281289.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://cdn-icons-png.flaticon.com/512/3281/3281289.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://cdn-icons-png.flaticon.com/512/3281/3281289.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            line-height: 1.6;
            background-color: #f9f9f9;
            color: #333;
        }

        /* User Bar Styles */
        .user-bar {
            background-color: #34495e;
            padding: 10px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            font-size: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            font-size: 15px;
        }

        .user-email {
            font-size: 13px;
            opacity: 0.8;
        }

        .logout-button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .logout-button:hover {
            background-color: #c0392b;
            transform: translateY(-1px);
        }

        .logout-button:active {
            transform: translateY(0);
        }

        /* Navigation Tabs */
        .nav-tab {
            background-color: #2c3e50;
            padding: 10px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-tab a {
            color: white;
            text-decoration: none;
            margin: 0 10px;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .nav-tab a:hover {
            background-color: #34495e;
        }

        /* Main Content Styles */
        header {
            background-color: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto 30px; /* Added bottom margin */
            background: white;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 8px; /* Added border radius */
        }

        .section-title {
            color: #3498db;
            font-size: 1.5em;
            margin: 25px 0 15px 0;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }

        .highlight-section {
            background-color: rgba(230, 126, 34, 0.1);
            padding: 15px;
            border-left: 4px solid #e67e22;
            border-radius: 0 4px 4px 0;
            margin: 15px 0;
        }

        .action-card {
            background-color: #e67e22;
            color: white;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }

        .media-container {
            text-align: center;
            margin: 20px 0;
        }

        .media-container img {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .caption {
            font-style: italic;
            color: #777;
            margin-top: 8px;
            font-size: 14px; /* Slightly smaller */
        }

        .question-item {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }

        .question-text {
            color: #2c3e50;
            font-weight: bold;
            margin-bottom: 10px;
        }

         /* Unified class for all answer fields */
        .editable-answer {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0 5px 0;
            background-color: white;
            min-height: 40px; /* Default min height for input/select */
            line-height: 1.5;
            display: block; /* Ensure block display */
            color: #333; /* Default text color */
        }

        /* Specific styles for textareas */
        .editable-answer[contenteditable="true"],
        textarea.editable-answer {
            min-height: 100px;
            cursor: text;
        }
        .editable-answer[contenteditable="true"]:empty:before,
        textarea.editable-answer:placeholder-shown:empty:before { /* Apply placeholder style to textarea too */
            content: attr(placeholder);
            color: #aaa;
            font-style: italic;
        }

        .editable-answer:focus { /* Add focus style */
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }


        .save-btn {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 6px 12px; /* Adjusted padding */
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-right: 5px;
            font-size: 13px; /* Smaller font size */
        }

        .delete-btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 6px 12px; /* Adjusted padding */
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
             font-size: 13px; /* Smaller font size */
        }

        .save-btn:hover {
            background-color: #219653;
        }

        .delete-btn:hover {
            background-color: #c0392b;
        }

        .saved-message {
            color: #27ae60;
            font-size: 12px; /* Smaller font */
            margin-left: 10px;
            display: none;
            font-style: italic;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 14px;
        }

        table, th, td {
            border: 1px solid #ddd;
            padding: 10px; /* Increased padding */
            text-align: left; /* Align text left */
        }

        th {
            background-color: #f2f2f2;
            font-weight: 600; /* Bold header */
        }

        .action-table {
            width: 100%;
            margin: 20px 0;
            background-color: #f8f9fa;
            border-radius: 6px;
            overflow: hidden; /* Keep rounded corners */
            border: 1px solid #ddd; /* Add subtle border */
        }

        .action-table th {
            background-color: #3498db;
            color: white;
            text-align: center; /* Center align header */
        }
        .action-table td {
            vertical-align: top; /* Align content top */
        }

        .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 20px;
        }

        .button {
            background-color: #3498db;
            color: white;
            padding: 12px 20px;
            border-radius: 4px;
            text-decoration: none;
            font-weight: bold;
            border: none;
            cursor: pointer;
            flex: 1;
            text-align: center;
            transition: all 0.3s; /* Smooth transition */
            font-size: 15px; /* Slightly larger font */
        }

        .button:hover {
            background-color: #2980b9;
            transform: translateY(-2px); /* Add subtle lift */
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
         .button:active {
             transform: translateY(0);
             box-shadow: none;
         }

        .button.back {
            background-color: #95a5a6;
        }

        .button.back:hover {
            background-color: #7f8c8d;
        }

        .warning-message { /* For the general warning below content */
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            color: #333;
            display: none; /* Initially hidden */
            font-size: 14px;
            line-height: 1.6;
            border-radius: 4px;
            font-weight: 500;
        }

        .required-field { /* Style for fields needing input */
            border: 2px solid #e74c3c !important;
            background-color: #fff2f2 !important; /* Lighter red background */
            animation: pulse 1.5s infinite alternate ease-in-out; /* Slower pulse */
        }

        @keyframes pulse {
            from { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.3); }
            to { box-shadow: 0 0 0 5px rgba(231, 76, 60, 0); }
        }

        @media (max-width: 600px) {
            .button-container {
                flex-direction: column;
            }
            .grow-model { grid-template-columns: 1fr; } /* Stack GROW steps */
            .skill-will-matrix { grid-template-columns: 1fr; } /* Stack matrix quadrants */
        }

        /* Section specific styles */
        .model-section, .trust-section, .rapport-section, .informal-tips {
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }
        .model-section { background-color: rgba(52, 152, 219, 0.08); border-left: 4px solid #3498db; }
        .trust-section { background-color: rgba(46, 204, 113, 0.08); border-left: 4px solid #2ecc71; }
        .rapport-section { background-color: rgba(155, 89, 182, 0.08); border-left: 4px solid #9b59b6; }
        .informal-tips { background-color: rgba(241, 196, 15, 0.08); border-left: 4px solid #f1c40f; }

        .grow-model {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Responsive grid */
            gap: 15px;
            margin: 20px 0;
        }

        .grow-step {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
            border-top: 4px solid #3498db;
        }

        .grow-step h4 { margin-top: 0; color: #3498db; }

        .skill-will-matrix {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 10px;
            margin: 20px 0;
        }

        .matrix-quadrant {
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }

        .matrix-quadrant h4 { margin-top: 0; }
        .guide { background-color: rgba(52, 152, 219, 0.1); border-top: 4px solid #3498db; }
        .delegate { background-color: rgba(46, 204, 113, 0.1); border-top: 4px solid #2ecc71; }
        .direct { background-color: rgba(231, 76, 60, 0.1); border-top: 4px solid #e74c3c; }
        .excite { background-color: rgba(241, 196, 15, 0.1); border-top: 4px solid #f1c40f; }

        .solution-model {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .solution-step {
            display: flex;
            align-items: flex-start; /* Align items top for longer text */
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
            border-left: 4px solid #3498db;
        }

        .step-number {
            background-color: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
            font-weight: bold;
        }

        .orange-header {
            background-color: #e67e22;
            color: white; /* White text on orange */
            padding: 10px;
            text-align: center;
            border-radius: 4px 4px 0 0;
            font-size: 14px;
            font-weight: bold;
        }

        .orange-row td { /* Apply to td in orange rows */
             background-color: rgba(230, 126, 34, 0.05); /* Lighter orange */
        }

        /* Styles for input/select within the orange table rows */
        .orange-row .editable-answer {
            width: auto; /* Allow natural width */
            min-width: 150px; /* Minimum width */
            margin: 5px 0; /* Vertical margin only */
            padding: 6px 8px;
            font-size: 13px;
            display: inline-block; /* Allow button group to be beside */
            vertical-align: middle;
            flex-grow: 1; /* Allow input/select to grow */
            color: black; /* <<< UPDATED: Black text color */
            background-color: white; /* Ensure background is white */
            border: 1px solid #ccc; /* Slightly darker border */
        }

        /* Style placeholder specifically within orange rows */
        .orange-row input.editable-answer::placeholder {
            color: #555; /* <<< UPDATED: Darker gray placeholder */
            opacity: 1; /* Ensure placeholder is not faded */
        }

        /* Container for input/select and buttons in the table cell */
        .table-input-group {
             display: flex;
             align-items: center;
             gap: 10px; /* Space between input and buttons */
             flex-wrap: wrap; /* Allow wrapping on small screens */
        }


        .drawing-together {
            display: flex;
            align-items: center;
            gap: 20px;
            background-color: rgba(155, 89, 182, 0.08);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #9b59b6;
        }

        .drawing-icon {
            font-size: 30px; /* Slightly smaller icon */
            color: #9b59b6;
            flex-shrink: 0;
        }

        .answer-buttons { /* Container for save/delete/status/error */
            display: flex;
            gap: 8px; /* Space between buttons */
            align-items: center; /* Vertically align items */
            margin-top: 8px; /* Space above buttons */
            flex-wrap: wrap; /* Allow wrapping */
        }

        /* --- Modal Styles --- */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6); /* Slightly darker overlay */
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: modalFadeInBackground 0.3s ease-out;
        }

        @keyframes modalFadeInBackground {
             from { background: rgba(0,0,0,0); }
             to { background: rgba(0,0,0,0.6); }
        }


        .modal-content {
            background: white;
            padding: 30px 40px; /* More padding */
            border-radius: 8px;
            max-width: 450px; /* Slightly wider */
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            position: relative;
            animation: modalSlideIn 0.3s ease-out;
        }

         @keyframes modalSlideIn {
             from { opacity: 0; transform: translateY(-30px); }
             to { opacity: 1; transform: translateY(0); }
        }


        .modal-button {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 12px 25px; /* Larger button */
            border-radius: 5px;
            cursor: pointer;
            margin-top: 25px; /* More space above button */
            font-weight: bold;
            transition: all 0.3s;
            font-size: 15px;
        }
        .modal-button:hover {
            background-color: #219653;
            transform: translateY(-2px);
             box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .close-modal {
            position: absolute;
            top: 15px; /* Position adjustments */
            right: 15px;
            background: none;
            border: none;
            font-size: 24px; /* Larger close icon */
            cursor: pointer;
            color: #aaa; /* Lighter color */
            transition: color 0.3s;
        }
        .close-modal:hover {
             color: #555; /* Darker on hover */
        }

         /* Error message specifically for required fields (inline) */
        .inline-error-message {
            color: #e74c3c;
            font-size: 12px;
            margin-left: 10px;
            display: none; /* Hidden by default */
            font-style: italic;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <!-- User Info Bar -->
    <div class="user-bar">
        <div class="user-info">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="opacity: 0.8;">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <div class="user-details">
                <span class="user-name" id="userName">Welcome back</span>
                <span class="user-email" id="userEmail">user@example.com</span>
            </div>
        </div>
        <button class="logout-button" onclick="logout()">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            Logout
        </button>
    </div>

    <!-- Navigation Tabs -->
    <nav class="nav-tab">
        <a href="index.html">Home</a>
        <a href="article1.html">Article 1</a>
        <a href="coaching-skills.html">Coaching Skills</a>
        <a href="coaching-individuals.html">Coaching Individuals</a>
        <a href="coaching-team.html">Team Coaching</a>
        <a href="coaching-yourself.html">Self Coaching</a>
    </nav>

    <header>
        <h1>Coaching Individuals</h1>
        <p>Professional development through effective coaching techniques</p>
    </header>

    <div class="container">
        <h2 class="section-title">The Power of Individual Coaching</h2>

        <div class="highlight-section">
            <p>Deep down, your team members likely already know the answers to their problems. As a coach, your job is to guide them toward this realization.</p>
        </div>

        <p>One-on-one coaching is a great way to provide this guidance. It's the most common form of coaching, and it's valuable in many ways. For example, it can help your team members to:</p>

        <ul>
            <li>Identify career goals, and develop plans to achieve them</li>
            <li>Improve their time-management and organizational skills</li>
            <li>Find the right work-life balance</li>
            <li>Make better decisions</li>
            <li>Develop skills to work more effectively</li>
            <li>Reduce stress</li>
            <li>Build more productive work relationships</li>
            <li>Think positively</li>
        </ul>

        <p>In an individual coaching relationship, it's important that you are humble, and that you always respect the other person's opinions. Never assume that you have the "right" answer. Make suggestions, but think of yourself as a partner, not a teacher. Remember that most of the time, the solutions to whatever issues your team members have lie within themselves.</p>

        <p>In this chapter, we'll look at some useful models that you can use to frame your one-on-one coaching conversations. We'll also discuss how to build successful coaching relationships, and how you can use coaching techniques informally, as well as in structured sessions.</p>

        <div class="media-container">
            <img src="https://images.unsplash.com/photo-1542744173-8e7e53415bb0?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80"
                 alt="Professional coaching session with two individuals engaged in discussion"
                 loading="lazy">
            <p class="caption">Effective one-on-one coaching builds trust and facilitates personal growth</p>
        </div>

        <h2 class="section-title">2.1. Useful Coaching Models</h2>

        <p>You may feel a little daunted by the prospect of coaching another person. After all, if you're like most leaders, you probably haven't received any formal coaching training. So, how do you know what to do or say to guide your team member effectively?</p>

        <p>Fortunately, there are many established models, techniques and approaches that you can use to structure your coaching sessions.</p>

        <!-- GROW Model Section -->
        <div class="model-section">
            <h3>1. The GROW Model</h3>
            <p>The GROW Model is a simple, yet powerful, coaching tool. GROW stands for:</p>

            <div class="grow-model">
                <div class="grow-step">
                    <h4>Goal</h4>
                    <p>What does your team member want to achieve? Help them identify clear, specific objectives.</p>
                </div>
                <div class="grow-step">
                    <h4>Reality</h4>
                    <p>What is the current situation? Explore the facts and perceptions about where they are now.</p>
                </div>
                <div class="grow-step">
                    <h4>Options</h4>
                    <p>What could your team member do? Brainstorm possible approaches and strategies.</p>
                </div>
                <div class="grow-step">
                    <h4>Will</h4>
                    <p>What will your team member do? Commit to specific actions and establish accountability.</p>
                </div>
            </div>

            <p>As a manager, you've likely already identified many of your team member's issues, and that's OK. You can still use the GROW Model as a guide that can help her to explore ideas, to come to her own conclusions, and to identify what she wants to achieve.</p>

            <h4>To use the GROW Model, follow these steps:</h4>
            <ol>
                <li><strong>Establish a goal</strong> - Help your team member identify what she wants to accomplish</li>
                <li><strong>Examine the person's situation</strong> - Explore the current reality</li>
                <li><strong>Explore the options (or obstacles)</strong> - Brainstorm possible approaches</li>
                <li><strong>Agree a plan</strong> - The coachee identifies the steps that he needs to take, and commits to specific actions that will move him toward his goal. At this point it's useful to discuss how he will stay motivated, and the strategies that he'll use to overcome any obstacles that arise. Finally, set a date to review his progress, and to revise the plan if necessary.</li>
            </ol>
        </div>

        <!-- Skill/Will Matrix Section -->
        <div class="model-section">
            <h3>2. The Skill/Will Matrix</h3>
            <p>Your team members all have their own needs, personalities, skills and abilities. This means that you will need to tailor your approach to fit each individual.</p>

            <p>The Skill/Will Matrix, developed by coach and author Max Landsberg in 2003, can enable you to find the appropriate coaching style for every situation.</p>

            <div class="skill-will-matrix">
                <div class="matrix-quadrant guide">
                    <h4>Guide</h4>
                    <p>For team members with <strong>high will but low skill</strong>. They're motivated but need direction and training.</p>
                </div>
                <div class="matrix-quadrant delegate">
                    <h4>Delegate</h4>
                    <p>For team members with <strong>high skill and high will</strong>. They're capable and motivated - give them autonomy.</p>
                </div>
                <div class="matrix-quadrant direct">
                    <h4>Direct</h4>
                    <p>For team members with <strong>low skill and low will</strong>. They need clear instructions and close supervision.</p>
                </div>
                <div class="matrix-quadrant excite">
                    <h4>Excite</h4>
                    <p>For team members with <strong>high skill but low will</strong>. They're capable but need motivation and inspiration.</p>
                </div>
            </div>

            <p>For example, if you are working with someone in the Direct quadrant, you might want to set clear guidelines, manage her progress closely, and encourage her to discuss any deadlines with you. But you could take a more "hands off" approach to coaching a team member who falls into the Delegate quadrant.</p>

            <table class="action-table">
                 <thead>
                    <tr>
                        <th colspan="2">ACTION: Create Your Coaching Map</th>
                    </tr>
                    <tr>
                        <td style="width: 30%; font-weight:bold;">Instructions</td>
                        <td>List your team members and identify where they fall on the Skill/Will Matrix</td>
                    </tr>
                 </thead>
            </table>

            <!-- Skill/Will Matrix Table -->
            <table>
                <thead>
                    <tr class="orange-header"> <!-- This header row has white text on orange BG -->
                        <th>Name of Team Member</th>
                        <th>The Coaching Map Quadrant</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Row 1 -->
                    <tr class="orange-row"> <!-- Cells in this row have light orange BG -->
                        <td><input type="text" class="editable-answer" placeholder="Enter name..." data-question="team-member1"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map1">
                                    <option value="">Select quadrant...</option>
                                    <option value="Guide">Guide (High Will, Low Skill)</option>
                                    <option value="Delegate">Delegate (High Will, High Skill)</option>
                                    <option value="Direct">Direct (Low Will, Low Skill)</option>
                                    <option value="Excite">Excite (Low Will, High Skill)</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team1')">Save</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team1')">Delete</button>
                                    <span class="saved-message" id="save-status-team1">✓ Saved</span>
                                    <span class="inline-error-message" id="error-team1">Both fields required.</span>
                                </div>
                             </div>
                        </td>
                    </tr>
                    <!-- Row 2 -->
                     <tr class="orange-row">
                        <td><input type="text" class="editable-answer" placeholder="Enter name..." data-question="team-member2"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map2">
                                    <option value="">Select quadrant...</option>
                                    <option value="Guide">Guide (High Will, Low Skill)</option>
                                    <option value="Delegate">Delegate (High Will, High Skill)</option>
                                    <option value="Direct">Direct (Low Will, Low Skill)</option>
                                    <option value="Excite">Excite (Low Will, High Skill)</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team2')">Save</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team2')">Delete</button>
                                    <span class="saved-message" id="save-status-team2">✓ Saved</span>
                                    <span class="inline-error-message" id="error-team2">Both fields required.</span>
                                </div>
                             </div>
                        </td>
                    </tr>
                     <!-- Row 3 -->
                     <tr class="orange-row">
                        <td><input type="text" class="editable-answer" placeholder="Enter name..." data-question="team-member3"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map3">
                                    <option value="">Select quadrant...</option>
                                    <option value="Guide">Guide (High Will, Low Skill)</option>
                                    <option value="Delegate">Delegate (High Will, High Skill)</option>
                                    <option value="Direct">Direct (Low Will, Low Skill)</option>
                                    <option value="Excite">Excite (Low Will, High Skill)</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team3')">Save</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team3')">Delete</button>
                                    <span class="saved-message" id="save-status-team3">✓ Saved</span>
                                    <span class="inline-error-message" id="error-team3">Both fields required.</span>
                                </div>
                             </div>
                        </td>
                    </tr>
                    <!-- Row 4 -->
                     <tr class="orange-row">
                        <td><input type="text" class="editable-answer" placeholder="Enter name..." data-question="team-member4"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map4">
                                    <option value="">Select quadrant...</option>
                                    <option value="Guide">Guide (High Will, Low Skill)</option>
                                    <option value="Delegate">Delegate (High Will, High Skill)</option>
                                    <option value="Direct">Direct (Low Will, Low Skill)</option>
                                    <option value="Excite">Excite (Low Will, High Skill)</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team4')">Save</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team4')">Delete</button>
                                    <span class="saved-message" id="save-status-team4">✓ Saved</span>
                                    <span class="inline-error-message" id="error-team4">Both fields required.</span>
                                </div>
                             </div>
                        </td>
                    </tr>
                     <!-- Row 5 -->
                     <tr class="orange-row">
                        <td><input type="text" class="editable-answer" placeholder="Enter name..." data-question="team-member5"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map5">
                                    <option value="">Select quadrant...</option>
                                    <option value="Guide">Guide (High Will, Low Skill)</option>
                                    <option value="Delegate">Delegate (High Will, High Skill)</option>
                                    <option value="Direct">Direct (Low Will, Low Skill)</option>
                                    <option value="Excite">Excite (Low Will, High Skill)</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team5')">Save</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team5')">Delete</button>
                                    <span class="saved-message" id="save-status-team5">✓ Saved</span>
                                    <span class="inline-error-message" id="error-team5">Both fields required.</span>
                                </div>
                             </div>
                        </td>
                    </tr>
                     <!-- Row 6 -->
                     <tr class="orange-row">
                        <td><input type="text" class="editable-answer" placeholder="Enter name..." data-question="team-member6"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map6">
                                    <option value="">Select quadrant...</option>
                                    <option value="Guide">Guide (High Will, Low Skill)</option>
                                    <option value="Delegate">Delegate (High Will, High Skill)</option>
                                    <option value="Direct">Direct (Low Will, Low Skill)</option>
                                    <option value="Excite">Excite (Low Will, High Skill)</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team6')">Save</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team6')">Delete</button>
                                    <span class="saved-message" id="save-status-team6">✓ Saved</span>
                                    <span class="inline-error-message" id="error-team6">Both fields required.</span>
                                </div>
                             </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Solution-Focused Coaching Section -->
        <div class="model-section">
            <h3>3. Solution-Focused Coaching</h3>
            <p>The Solution-Focused Coaching approach helps you to identify what your team member wants, and how he can achieve it. Your aim is not to examine why a specific problem is occurring, but to find a solution. This helps you to avoid dwelling on the negatives. It's a simple and positive way to coach someone.</p>

            <div class="solution-model">
                <div class="solution-step">
                    <div class="step-number">1</div>
                    <div>
                        <h4>Identify a goal or solution</h4>
                        <p>What does your team member want to achieve? Help them define a clear, specific outcome.</p>
                    </div>
                </div>
                <div class="solution-step">
                    <div class="step-number">2</div>
                    <div>
                        <h4>Create a plan</h4>
                        <p>How can they reach their goal? Develop actionable steps and strategies together.</p>
                    </div>
                </div>
                <div class="solution-step">
                    <div class="step-number">3</div>
                    <div>
                        <h4>Take action and monitor progress</h4>
                        <p>Implement the plan and track results. Provide support and adjust as needed.</p>
                    </div>
                </div>
                <div class="solution-step">
                    <div class="step-number">4</div>
                    <div>
                        <h4>Change what isn't working</h4>
                        <p>Adjust the approach based on what's effective and what needs improvement.</p>
                    </div>
                </div>
            </div>

            <div class="question-item">
                <div class="question-text">1. What specific goal would you help your team member identify using this approach?</div>
                <!-- Use textarea, add required class and data-question -->
                <textarea class="editable-answer required-answer" data-question="solution-goal" placeholder="Enter your answer here..."></textarea>
                <div class="answer-buttons">
                    <button class="save-btn" onclick="saveAnswer('solution-goal')">Save</button>
                    <button class="delete-btn" onclick="deleteAnswer('solution-goal')">Delete</button>
                    <span class="saved-message" id="save-status-solution-goal">✓ Saved</span>
                    <span class="inline-error-message" id="error-solution-goal">Please enter an answer.</span>
                </div>
            </div>

            <div class="question-item">
                <div class="question-text">2. How would you help them create an effective action plan?</div>
                 <!-- Use textarea, add required class and data-question -->
                <textarea class="editable-answer required-answer" data-question="solution-plan" placeholder="Enter your answer here..."></textarea>
                <div class="answer-buttons">
                    <button class="save-btn" onclick="saveAnswer('solution-plan')">Save</button>
                    <button class="delete-btn" onclick="deleteAnswer('solution-plan')">Delete</button>
                    <span class="saved-message" id="save-status-solution-plan">✓ Saved</span>
                    <span class="inline-error-message" id="error-solution-plan">Please enter an answer.</span>
                </div>
            </div>

            <p>This model is effective for most people, in most situations. However, if your team member wants to explore the deeper issues behind her behavior or actions, you might want to take a different approach.</p>
        </div>

        <!-- Building Trust Section -->
        <h2 class="section-title">2.2. Setting up a Coaching Relationship</h2>
        <p>Trust and rapport are two of the most important aspects of a successful coaching relationship. Without them, your team member is unlikely to share his thoughts and feelings with you.</p>
        <div class="trust-section">
            <h3>Building Trust</h3>
            <p>There are several ways to develop trust with your team member:</p>
            <h4>1. Demonstrate Your Credibility</h4>
            <p>Your coachee needs to feel that you have the knowledge and skills to help her. That is why credibility is so important.</p>
            <p>Your existing relationship with your colleague likely makes you a credible coach, but remember that your role as a coach is very different from your role as a manager.</p>
            <p>In your coaching sessions, show confidence by avoiding hesitation, making eye contact, and smiling. But, if you don't have all the answers, don't be afraid to admit it. If you're open and honest with your team member, your credibility will increase. What's more important is that you have the resources to find the answers together.</p>
            <h4>2. Show Your Reliability</h4>
            <p>Another important aspect of building trust is reliability. Your team member needs to know that he can depend on you, in every situation.</p>
            <p>To show that you're reliable, make sure that you do what you say you'll do, without fail. Be sure to turn up for your coaching sessions on time, to return messages and calls promptly, and to remain sensitive to your coachee's preferences and expectations.</p>
            <h4>3. Make the Other Person Comfortable</h4>
            <p>When your team member feels secure and comfortable, she's more likely to open up and share what she's really thinking. This only tends to develop once you know someone well.</p>
            <p>You can help this process along by sharing some personal information about yourself, too. This doesn't mean that you have to self-disclose every detail about your life! But telling stories from your past, or talking about your values and beliefs, will show that you trust her with your personal information.</p>
            <p>You need to find the right balance between how much to tell her and how much you keep to yourself.</p>
            <h4>4. Show That You Care</h4>
            <p>Your coachee needs to feel that you have his best interests at heart, and that your relationship isn't just about improving the quality of his work or increasing his productivity.</p>
            <p>So, take an active interest in his life. Be clear that you are available at short notice if he needs to talk to you. And, if your coaching plan takes longer than you expect to bear fruit, be patient and demonstrate your commitment to the process.</p>
        </div>

        <!-- Building Rapport Section -->
        <div class="rapport-section">
            <h3>Building Rapport</h3>
            <p>At the start of a coaching relationship, it's important to build a rapport with your team member. But this can be more difficult than it sounds!</p>
            <p>To help the process along, find out what the two of you have in common. You can do this by asking her questions about herself, and about what's happening in her life.</p>
            <p>The six levels of rapport were originally identified by Gregory Bateson in 1964, and developed further by Robert Dilts in 1990. They are:</p>
            <ol>
                <li><strong>Environment</strong> - What do you have in common (work, location, background, and so on)?</li>
                <li><strong>Behavior</strong> - Do you do similar things out of work?</li>
                <li><strong>Capability</strong> - Do you share any skills or abilities?</li>
                <li><strong>Beliefs</strong> - Do you have the same values or beliefs?</li>
                <li><strong>Identity</strong> - Do you share a sense of who you are?</li>
                <li><strong>Spirit</strong> - Do you have a similar spiritual outlook on life?</li>
            </ol>
        </div>

        <!-- Informal Coaching Section -->
        <h2 class="section-title">2.3. Informal Coaching</h2>
        <p>You don't have to wait for a structured session to use your coaching skills. Good coaches engage with their team members daily, or weekly.</p>
        <div class="informal-tips">
            <p>You can identify informal coaching opportunities in several ways:</p>
            <h3>1. Keep on Top of Workloads</h3>
            <p>Stay in touch with your team members' workloads. When people are overloaded, or they're trying to juggle too many responsibilities, an informal coaching session can help them to prioritize their tasks, or to gain a clearer understanding of what's most important.</p>
            <p>Adjust your schedule during busy times so that you're available to help when your team members need you.</p>
            <h3>2. Be Aware of People's Moods</h3>
            <p>A change in a person's mood might prompt you to start an informal coaching conversation.</p>
            <p>For example, imagine that you've walked by a team member's desk. His shoulders are slumped, his head is down, and he's staring blankly at his computer screen. Sure, he may just be recovering from a big lunch! Or, he might have just learned that his most promising client went to your competitor.</p>
            <p>The point is, his body language is telling you that something is wrong. If he's just eaten too much, you could encourage him to take a quick walk outside. But, if it's something more serious, you're in the right place at the right time for a quick coaching session.</p>
            <p>There are many situations where people can benefit from an informal coaching conversation - for example, when they've received feedback, or after a performance review. Team members might also need support if they experience an anticlimax after achieving a major goal, or if a project or presentation didn't go as well as they'd hoped.</p>
            <h3>3. Ask for Permission</h3>
            <p>Informal coaching can be a valuable experience for your team member. However, she might not appreciate it if she's in the middle of doing something important!</p>
            <p>Be sure to check that it's a good time to have a coaching conversation.</p>
            <h3>4. Don't Tell People What to Do</h3>
            <p>Remember, your goal as a coach is not to offer advice or to give specific instructions. The best coaches ask questions, and listen more than they talk.</p>
            <p>If you find yourself using the words "I think..." during a coaching session, you may need to re-examine your approach.</p>
            <h3>5. Use Informal Moments</h3>
            <p>The best time to have an informal coaching conversation is when you both feel relaxed. Rather than organize a formal meeting, you could talk to your team member over a cup of coffee in your break room, or during lunch, instead.</p>
            <p>The goal here is to be relaxed, while remaining professional.</p>
        </div>

        <div class="media-container">
            <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80"
                 alt="Casual coaching conversation in a workplace setting"
                 loading="lazy">
            <p class="caption">Informal coaching often happens spontaneously in the workplace</p>
        </div>

         <table class="action-table">
             <thead>
                <tr>
                    <th colspan="2">ACTION: Practice Informal Coaching</th>
                </tr>
                <tr>
                    <td style="width: 30%; font-weight: bold;">Instructions</td>
                    <td>Consider what you've learned about informal coaching sessions. Then, answer the questions below.</td>
                </tr>
             </thead>
        </table>

        <!-- Informal Coaching Questions -->
        <div class="question-item">
            <div class="question-text">1. How did you initiate the conversation?</div>
            <!-- Use textarea, add required class and data-question -->
            <textarea class="editable-answer required-answer" data-question="informal-initiate" placeholder="Enter your answer here..."></textarea>
            <div class="answer-buttons">
                <button class="save-btn" onclick="saveAnswer('informal-initiate')">Save</button>
                <button class="delete-btn" onclick="deleteAnswer('informal-initiate')">Delete</button>
                <span class="saved-message" id="save-status-informal-initiate">✓ Saved</span>
                <span class="inline-error-message" id="error-informal-initiate">Please enter an answer.</span>
            </div>
        </div>

        <div class="question-item">
            <div class="question-text">2. How did you know that the person would benefit from an informal coaching session? What were the clues?</div>
             <!-- Use textarea, add required class and data-question -->
            <textarea class="editable-answer required-answer" data-question="informal-benefit" placeholder="Enter your answer here..."></textarea>
            <div class="answer-buttons">
                <button class="save-btn" onclick="saveAnswer('informal-benefit')">Save</button>
                <button class="delete-btn" onclick="deleteAnswer('informal-benefit')">Delete</button>
                <span class="saved-message" id="save-status-informal-benefit">✓ Saved</span>
                <span class="inline-error-message" id="error-informal-benefit">Please enter an answer.</span>
            </div>
        </div>

        <div class="question-item">
            <div class="question-text">3. Was your team member receptive to you?</div>
             <!-- Use textarea, add required class and data-question -->
            <textarea class="editable-answer required-answer" data-question="informal-receptive" placeholder="Enter your answer here..."></textarea>
            <div class="answer-buttons">
                <button class="save-btn" onclick="saveAnswer('informal-receptive')">Save</button>
                <button class="delete-btn" onclick="deleteAnswer('informal-receptive')">Delete</button>
                <span class="saved-message" id="save-status-informal-receptive">✓ Saved</span>
                 <span class="inline-error-message" id="error-informal-receptive">Please enter an answer.</span>
            </div>
        </div>

        <!-- Drawing Together Section -->
        <h2 class="section-title">2.4. Drawing This Together</h2>
        <div class="drawing-together">
            <div class="drawing-icon">✓</div>
            <div>
                <p>In this chapter, we discussed how to coach an individual member of your team. We outlined several models to guide your approach, and found out how to get your coaching relationships off to a great start. We also explored building trust and rapport with your team members.</p>
                <p>The next chapter focuses on how to coach a team. We'll look at how group coaching works, and examine several models and processes that you can use to do it.</p>
            </div>
        </div>

        <!-- General Warning Message (for Next Button click) -->
        <div class="warning-message" id="generalWarningMessage">
            <strong>Action Required:</strong> Please complete all required answers before proceeding.
            Unanswered questions are highlighted.
        </div>

        <!-- Navigation Buttons -->
        <div class="button-container">
            <!-- Updated Back Button Navigation -->
            <a href="coaching-skills.html" class="button back" id="backButton">← Back to Coaching Skills</a>
            <!-- Next button will trigger validation and potentially the modal -->
            <button type="button" class="button" id="nextButton">Next: Team Coaching →</button>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal-overlay">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal()">×</button>
            <h3>Section Complete!</h3>
            <p>All required answers for this section have been saved.</p>
            <p>You can now proceed to the next section.</p>
            <button class="modal-button" onclick="redirectToNextPage()">CONTINUE TO TEAM COACHING</button>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const formspreeEndpoint = 'https://formspree.io/f/xzzeqvea'; // YOUR Formspree Endpoint
        const localStorageKey = 'allUserAnswers_coachingIndividuals'; // Specific key for THIS page
        const userEmailKey = 'userEmail';
        const currentUserKey = 'currentUser';

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', function() {
            const userEmail = getUserEmail();
            if (!userEmail) {
                alert('User session not found. Please log in again.');
                window.location.href = 'login.html';
                return;
            }

            displayUserInfo(userEmail);
            loadUserAnswers(userEmail);
            setupEventListeners(userEmail);
        });

        // --- User Info & Authentication ---
        function getUserEmail() {
            const userData = JSON.parse(localStorage.getItem(currentUserKey));
            return userData?.email || localStorage.getItem(userEmailKey);
        }

        function displayUserInfo(userEmail) {
            const userData = JSON.parse(localStorage.getItem(currentUserKey)) || {};
            document.getElementById('userName').textContent = `Welcome, ${userData.name || 'User'}`;
            document.getElementById('userEmail').textContent = userEmail;
        }

        function logout() {
            localStorage.removeItem('loggedIn');
            localStorage.removeItem(currentUserKey);
            localStorage.removeItem(userEmailKey);
            window.location.href = 'login.html';
        }

        // --- Answer Handling (Local Storage) ---
        function loadUserAnswers(userEmail) {
            const allAnswers = JSON.parse(localStorage.getItem(localStorageKey)) || {};
            const userPageAnswers = allAnswers[userEmail] || {};

            // Load answers for textareas
            document.querySelectorAll('textarea.editable-answer').forEach(field => {
                 const questionId = field.getAttribute('data-question');
                 const statusId = `save-status-${questionId}`;
                 const statusElement = document.getElementById(statusId);

                 if (userPageAnswers[questionId] !== undefined) {
                    field.value = userPageAnswers[questionId];
                    field.classList.remove('required-field');
                    if (userPageAnswers[questionId].trim() !== '' && statusElement) {
                         statusElement.textContent = '✓ Saved';
                         statusElement.style.display = 'inline';
                    } else if (statusElement) {
                        statusElement.style.display = 'none';
                    }
                 } else {
                    field.value = '';
                    if (statusElement) statusElement.style.display = 'none';
                 }
            });

             // Load answers for Skill/Will matrix (inputs and selects)
             for (let i = 1; i <= 6; i++) {
                 const nameQuestionId = `team-member${i}`;
                 const mapQuestionId = `coaching-map${i}`;
                 const statusId = `save-status-team${i}`;
                 const statusElement = document.getElementById(statusId);
                 const nameField = document.querySelector(`[data-question="${nameQuestionId}"]`);
                 const mapField = document.querySelector(`[data-question="${mapQuestionId}"]`);

                 if (nameField && userPageAnswers[nameQuestionId] !== undefined) {
                     nameField.value = userPageAnswers[nameQuestionId];
                 } else if (nameField) {
                     nameField.value = '';
                 }
                 // No need to add/remove required-field class on load for name field

                 if (mapField && userPageAnswers[mapQuestionId] !== undefined) {
                     mapField.value = userPageAnswers[mapQuestionId];
                     mapField.classList.remove('required-field'); // Remove if loaded
                 } else if (mapField) {
                     mapField.value = ''; // Reset to default option
                 }

                 // Show saved status only if BOTH fields have saved values for that row
                 if (nameField && mapField && statusElement &&
                     userPageAnswers[nameQuestionId]?.trim() && userPageAnswers[mapQuestionId]?.trim()) {
                    statusElement.textContent = '✓ Saved';
                    statusElement.style.display = 'inline';
                 } else if (statusElement) {
                     statusElement.style.display = 'none';
                 }
             }
        }


        function saveAnswerToStorage(userEmail, questionId, answer) {
            const allAnswers = JSON.parse(localStorage.getItem(localStorageKey)) || {};
            if (!allAnswers[userEmail]) {
                allAnswers[userEmail] = {};
            }
            allAnswers[userEmail][questionId] = answer;
            localStorage.setItem(localStorageKey, JSON.stringify(allAnswers));
            console.log(`Saved locally: ${questionId}`);
        }

        function deleteAnswerFromStorage(userEmail, questionId) {
            const allAnswers = JSON.parse(localStorage.getItem(localStorageKey)) || {};
            if (allAnswers[userEmail]) {
                delete allAnswers[userEmail][questionId];
                if (Object.keys(allAnswers[userEmail]).length === 0) {
                    delete allAnswers[userEmail];
                }
            }
            localStorage.setItem(localStorageKey, JSON.stringify(allAnswers));
             console.log(`Deleted locally: ${questionId}`);
        }

        // --- Event Listeners Setup ---
        function setupEventListeners(userEmail) {
             // Auto-remove required styling on input/change
             document.querySelectorAll('.required-answer, input.editable-answer[data-question^="team-member"], select.editable-answer[data-question^="coaching-map"]').forEach(field => {
                 const eventType = (field.tagName === 'SELECT' || field.tagName === 'INPUT') ? 'input' : 'input'; // Use input for text/select
                 field.addEventListener(eventType, function() {
                     const questionId = this.getAttribute('data-question');
                     let errorId = '';
                     let errorElement = null;

                      if (this.classList.contains('required-answer')) {
                          errorId = `error-${questionId}`;
                          errorElement = document.getElementById(errorId);
                      } else if (questionId.startsWith('team-member') || questionId.startsWith('coaching-map')) {
                           const rowNum = questionId.slice(-1);
                           errorId = `error-team${rowNum}`;
                           errorElement = document.getElementById(errorId);
                      }


                     if (this.value.trim() !== '') {
                         this.classList.remove('required-field');
                         if (errorElement && this.classList.contains('required-answer')) {
                             errorElement.style.display = 'none'; // Hide individual error message
                         }


                         // Special check for combined fields - remove combined error ONLY if BOTH now have value
                         if (questionId.startsWith('team-member') || questionId.startsWith('coaching-map')) {
                             const rowNum = questionId.slice(-1);
                             const nameField = document.querySelector(`[data-question="team-member${rowNum}"]`);
                             const mapField = document.querySelector(`[data-question="coaching-map${rowNum}"]`);
                             const combinedErrorElement = document.getElementById(`error-team${rowNum}`);

                             // Remove red border from the specific field being typed into/changed
                             this.classList.remove('required-field');

                             // Hide the COMBINED error message if BOTH fields are now filled
                             if (nameField.value.trim() !== '' && mapField.value.trim() !== '' && combinedErrorElement) {
                                 combinedErrorElement.style.display = 'none';
                                 // Also remove red borders from both if the error is hidden
                                 nameField.classList.remove('required-field');
                                 mapField.classList.remove('required-field');
                             }
                         }
                     }
                 });
             });

            // Next button validation & modal trigger
            document.getElementById('nextButton').addEventListener('click', function(e) {
                if (!validateAllAnswers()) {
                    e.preventDefault();
                    showGeneralWarningMessage();
                } else {
                    // Prevent default navigation if validation passes but we want to show modal
                    e.preventDefault();
                    showSuccessModal();
                }
            });
        }

        // --- UI Feedback & Validation ---

        function validateAllAnswers() {
            let allValid = true;
            const userEmail = getUserEmail();
            const allAnswers = JSON.parse(localStorage.getItem(localStorageKey)) || {};
            const userPageAnswers = allAnswers[userEmail] || {};

            // Check required textareas based on their CURRENT value OR saved value
            document.querySelectorAll('textarea.required-answer').forEach(field => {
                const questionId = field.getAttribute('data-question');
                const errorId = `error-${questionId}`;
                const errorElement = document.getElementById(errorId);
                const currentValue = field.value.trim();
                const savedValue = userPageAnswers[questionId]?.trim();

                 if (!currentValue && !savedValue) { // Invalid if neither current nor saved value exists
                    allValid = false;
                    field.classList.add('required-field');
                    if (errorElement) {
                        errorElement.textContent = 'Please enter an answer.';
                        errorElement.style.display = 'inline';
                    }
                } else {
                    field.classList.remove('required-field');
                    if (errorElement) errorElement.style.display = 'none';
                }
            });

            // Check Skill/Will Matrix rows (only validate map if name is entered or saved)
             for (let i = 1; i <= 6; i++) {
                const nameField = document.querySelector(`[data-question="team-member${i}"]`);
                const mapField = document.querySelector(`[data-question="coaching-map${i}"]`);
                const errorId = `error-team${i}`;
                const errorElement = document.getElementById(errorId);

                if (nameField && mapField) {
                    const nameQuestionId = `team-member${i}`;
                    const mapQuestionId = `coaching-map${i}`;

                    const currentNameValue = nameField.value.trim();
                    const currentMapValue = mapField.value.trim();
                    const savedNameValue = userPageAnswers[nameQuestionId]?.trim();
                    const savedMapValue = userPageAnswers[mapQuestionId]?.trim();

                    const hasName = currentNameValue || savedNameValue; // Consider name present if current or saved
                    const hasMap = currentMapValue || savedMapValue; // Consider map present if current or saved

                    // Reset styles first
                    nameField.classList.remove('required-field');
                    mapField.classList.remove('required-field');
                    if (errorElement) errorElement.style.display = 'none';


                    // If a name is present (current or saved), the map selection becomes required (current or saved)
                    if (hasName && !hasMap) {
                         allValid = false;
                         mapField.classList.add('required-field'); // Highlight the select dropdown
                         if (errorElement) {
                             errorElement.textContent = 'Please select a quadrant.';
                             errorElement.style.display = 'inline';
                         }
                    }
                     // Optional: Could also validate that if a map is selected, a name must be present
                     /* else if (!hasName && hasMap) {
                          allValid = false;
                          nameField.classList.add('required-field'); // Highlight the name input
                          if (errorElement) {
                              errorElement.textContent = 'Please enter a name.';
                              errorElement.style.display = 'inline';
                          }
                     } */
                     // Current logic: Only enforce map if name exists. Allow empty rows.
                }
            }


            return allValid;
        }


        function showGeneralWarningMessage() {
            const warningElement = document.getElementById('generalWarningMessage');
            if (!warningElement) return;
            warningElement.style.display = 'block';
            warningElement.style.animation = 'fadeIn 0.3s ease-in-out';

            const firstEmptyField = document.querySelector('.required-field');
            if (firstEmptyField) {
                firstEmptyField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                // Small delay before focus sometimes helps after scrollIntoView
                setTimeout(() => {
                     try { firstEmptyField.focus({ preventScroll: true }); } catch(e) { /* ignore potential errors */ }
                }, 150); // Slightly longer delay
            }

            setTimeout(() => {
                warningElement.style.animation = 'fadeOut 0.5s ease-in-out forwards';
                 setTimeout(() => {
                      warningElement.style.display = 'none';
                      warningElement.style.animation = '';
                 }, 500);
            }, 4000); // Show for 4 seconds
        }

         function showSaveStatus(statusId, message = '✓ Saved') {
             const statusElement = document.getElementById(statusId);
             if (!statusElement) return;
             statusElement.textContent = message;
             statusElement.style.display = 'inline';
             setTimeout(() => {
                 statusElement.style.display = 'none';
             }, 2500); // Show for 2.5 seconds
        }

        function showError(errorId, field, message = 'Required field.') {
             const errorElement = document.getElementById(errorId);
             if (!errorElement) return;
             errorElement.textContent = message;
             errorElement.style.display = 'inline';
             if (field) { // Only add class and focus if field is provided
                 field.classList.add('required-field');
                  try { field.focus({ preventScroll: true }); } catch(e) { /* ignore potential errors */ }
             }
        }

        function hideMessages(statusId, errorId, field) {
             const statusElement = document.getElementById(statusId);
             const errorElement = document.getElementById(errorId);
             if (statusElement) statusElement.style.display = 'none';
             if (errorElement) errorElement.style.display = 'none';
             if (field) field.classList.remove('required-field');
        }

        // --- Actions (Save, Delete for Textareas) ---
        function saveAnswer(questionId) {
             const userEmail = getUserEmail();
             if (!userEmail) return; // Auth check

             const field = document.querySelector(`[data-question="${questionId}"]`);
             if (!field) { console.error(`Field not found for ${questionId}`); return; }

             const statusId = `save-status-${questionId}`;
             const errorId = `error-${questionId}`;
             const answer = field.value.trim(); // Use trimmed value for validation

             hideMessages(statusId, errorId, field);

             if (!answer && field.classList.contains('required-answer')) { // Check if required and empty
                showError(errorId, field, 'Please enter an answer.');
                return;
             }

             // Save the original value (including whitespace if desired, though usually trim is preferred)
             saveAnswerToStorage(userEmail, questionId, field.value);
             submitToFormspree(userEmail, questionId, field.value); // Submit original value
             showSaveStatus(statusId);
             field.classList.remove('required-field'); // Ensure field is not marked required after save
             if(document.getElementById(errorId)) document.getElementById(errorId).style.display = 'none'; // Hide error message
        }

        function deleteAnswer(questionId) {
            const userEmail = getUserEmail();
            if (!userEmail) return; // Auth check

            const field = document.querySelector(`[data-question="${questionId}"]`);
             if (!field) { console.error(`Field not found for ${questionId}`); return; }

             const statusId = `save-status-${questionId}`;
             const errorId = `error-${questionId}`;

             hideMessages(statusId, errorId, field);
             field.value = '';
             deleteAnswerFromStorage(userEmail, questionId);
             showSaveStatus(statusId, '✓ Deleted');
             // Don't add required-field on delete, validation handles it
        }

        // --- Actions (Save, Delete for Combined Skill/Will Rows) ---
         function saveCombinedAnswer(rowIdentifier) { // e.g., rowIdentifier = 'team1'
             const userEmail = getUserEmail();
             if (!userEmail) return;

             const nameQuestionId = `team-member${rowIdentifier.slice(-1)}`;
             const mapQuestionId = `coaching-map${rowIdentifier.slice(-1)}`;
             const statusId = `save-status-${rowIdentifier}`;
             const errorId = `error-${rowIdentifier}`;

             const nameField = document.querySelector(`[data-question="${nameQuestionId}"]`);
             const mapField = document.querySelector(`[data-question="${mapQuestionId}"]`);
             const errorElement = document.getElementById(errorId);

             if (!nameField || !mapField) { console.error(`Fields not found for ${rowIdentifier}`); return; }

             const nameValue = nameField.value.trim();
             const mapValue = mapField.value.trim();

             // Hide previous messages first
              hideMessages(statusId, errorId, null); // Hide combined message first
              nameField.classList.remove('required-field'); // Clear potential individual highlights
              mapField.classList.remove('required-field');


             // Validate: BOTH must be filled to save this row
             let rowValid = true;
             if (!nameValue) {
                 showError(errorId, null, 'Both Name and Quadrant are required to save.');
                 nameField.classList.add('required-field');
                 rowValid = false;
             }
              if (!mapValue) {
                  // Show error only once if both are missing
                  if(rowValid) showError(errorId, null, 'Both Name and Quadrant are required to save.');
                  mapField.classList.add('required-field');
                  rowValid = false;
             }

             if (!rowValid) return;


             // Save both pieces of data
             saveAnswerToStorage(userEmail, nameQuestionId, nameField.value);
             saveAnswerToStorage(userEmail, mapQuestionId, mapField.value);

             // Submit both pieces individually to Formspree
             submitToFormspree(userEmail, nameQuestionId, nameField.value);
             submitToFormspree(userEmail, mapQuestionId, mapField.value);

             showSaveStatus(statusId);
             nameField.classList.remove('required-field'); // Ensure fields are not marked required after save
             mapField.classList.remove('required-field');
             if(errorElement) errorElement.style.display = 'none';
         }

         function deleteCombinedAnswer(rowIdentifier) {
             const userEmail = getUserEmail();
             if (!userEmail) return;

             const nameQuestionId = `team-member${rowIdentifier.slice(-1)}`;
             const mapQuestionId = `coaching-map${rowIdentifier.slice(-1)}`;
             const statusId = `save-status-${rowIdentifier}`;
             const errorId = `error-${rowIdentifier}`;

             const nameField = document.querySelector(`[data-question="${nameQuestionId}"]`);
             const mapField = document.querySelector(`[data-question="${mapQuestionId}"]`);

             if (!nameField || !mapField) { console.error(`Fields not found for ${rowIdentifier}`); return; }

             // Hide messages and remove red borders
             hideMessages(statusId, errorId, null); // Hide combined message first
             nameField.classList.remove('required-field');
             mapField.classList.remove('required-field');


             nameField.value = '';
             mapField.value = ''; // Reset select to default

             deleteAnswerFromStorage(userEmail, nameQuestionId);
             deleteAnswerFromStorage(userEmail, mapQuestionId);

             showSaveStatus(statusId, '✓ Deleted');
         }


        // --- Formspree Submission ---
        function submitToFormspree(userEmail, questionId, answer) {
            // Submit even if the answer is just whitespace, but maybe not if completely empty string?
            // Let's submit if answer exists (even whitespace), Formspree can handle it.
             if (answer === undefined || answer === null) {
                 console.log(`Skipping Formspree submission for undefined/null answer: ${questionId}`);
                 return;
             }

            const formData = new FormData();
            formData.append('email', userEmail);
            formData.append('page', document.title + " (Coaching Individuals)"); // Add page context
            formData.append('question_id', questionId);
            formData.append('answer_text', answer); // Send the potentially non-trimmed answer

            fetch(formspreeEndpoint, {
                method: 'POST',
                body: formData,
                headers: { 'Accept': 'application/json' }
            })
            .then(response => {
                if (response.ok) {
                    console.log(`Answer submitted to Formspree: ${questionId}`);
                } else {
                     response.json().then(data => {
                         console.error(`Formspree error for ${questionId}:`, data.errors ? data.errors.map(e => e.message).join(', ') : `Status ${response.status}`);
                    }).catch(() => console.error(`Formspree non-JSON error for ${questionId}. Status: ${response.status}`));
                }
            })
            .catch(error => console.error(`Network error submitting to Formspree for ${questionId}:`, error));
        }

        // --- Modal Handling ---
        function showSuccessModal() {
             const modal = document.getElementById('successModal');
             if(modal) modal.style.display = 'flex';
        }

        function closeModal() {
            const modal = document.getElementById('successModal');
            if(modal) modal.style.display = 'none';
        }

        function redirectToNextPage() {
            window.location.href = 'coaching-team.html'; // Make sure this is the correct next page filename
        }

    </script>
</body>
</html>
