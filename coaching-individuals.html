<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coaching Individuals</title>
    <!-- Favicon Links -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://cdn-icons-png.flaticon.com/512/3281/3281289.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://cdn-icons-png.flaticon.com/512/3281/3281289.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://cdn-icons-png.flaticon.com/512/3281/3281289.png">
    <style>
        /* --- Global Styles --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        html { scroll-behavior: smooth; }

        body {
            margin: 0;
            padding: 0;
            line-height: 1.7; /* Adjusted from 1.6 */
            background-color: #f9f9f9; /* Consistent background */
            color: #333;
        }

        /* --- User Bar Styles (Consistent) --- */
        .user-bar {
            background-color: #34495e;
            padding: 10px 20px; /* Adjusted from 30px */
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            font-size: 14px; /* Adjusted from 15px */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .user-info { display: flex; align-items: center; gap: 12px; /* Adjusted from 15px */ }
        .user-info svg { opacity: 0.8; }
        .user-details { display: flex; flex-direction: column; }
        .user-name { font-weight: 600; font-size: 14px; /* Adjusted */ }
        .user-email { font-size: 12px; opacity: 0.8; /* Adjusted */ }
        .logout-button {
            background-color: #e74c3c; /* Consistent Red */
            color: white; border: none; padding: 8px 15px; /* Adjusted */
            border-radius: 6px; cursor: pointer; font-weight: 500;
            transition: all 0.3s ease; display: flex; align-items: center;
            gap: 6px; font-size: 13px; /* Adjusted */
        }
        .logout-button:hover { background-color: #c0392b; transform: translateY(-1px); }
        .logout-button:active { transform: translateY(0); }

        /* --- Navigation Tabs (Consistent) --- */
        .nav-tab {
            background-color: #2c3e50;
            padding: 12px 10px; /* Adjusted */
            text-align: center; position: sticky; top: 0; z-index: 100;
            overflow-x: auto; white-space: nowrap; -webkit-overflow-scrolling: touch;
            scrollbar-width: thin; scrollbar-color: #556a80 #2c3e50;
        }
        .nav-tab::-webkit-scrollbar { height: 6px; }
        .nav-tab::-webkit-scrollbar-track { background: #2c3e50; }
        .nav-tab::-webkit-scrollbar-thumb { background-color: #556a80; border-radius: 10px; border: 1px solid #2c3e50; }
        .nav-tab a {
            color: white; text-decoration: none; margin: 0 8px; /* Adjusted */
            padding: 8px 12px; /* Adjusted */ border-radius: 6px;
            transition: background-color 0.3s, color 0.3s; font-size: 14px;
            display: inline-block;
        }
        .nav-tab a:hover,
        .nav-tab a.active { /* Use standard hover */
            background-color: #34495e;
            color: #fff;
        }

        /* --- Main Content Styles (Consistent) --- */
        h1 { /* Replaced header tag styling */
            color: #fff;
            background-color: #e67e22; /* Standard Orange */
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin: 25px auto;
            max-width: 800px;
            font-size: 26px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        h1 + p { /* Style for subtitle below h1 */
            text-align: center;
            margin-top: -15px;
            margin-bottom: 25px;
            color: #555;
            font-size: 15px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto 30px;
            background: white;
            padding: 30px; /* Increased padding */
            box-shadow: 0 0 10px rgba(0,0,0,0.1); /* Consistent shadow */
            border-radius: 8px;
        }

        .section-title {
            color: #e67e22; /* Standard Orange */
            font-size: 1.6em; /* Slightly larger */
            margin: 30px 0 15px 0;
            border-bottom: 2px solid #e67e22; /* Orange border */
            padding-bottom: 8px;
            font-weight: 600;
        }

        .highlight-section { /* Consistent */
            background-color: rgba(230, 126, 34, 0.07);
            padding: 20px;
            border-left: 5px solid #e67e22;
            border-radius: 6px;
            margin: 25px 0;
        }

        .action-card { /* Use action-box style */
            background-color: #e67e22; /* Standard Orange */
            color: white;
            padding: 20px;
            border-radius: 6px;
            margin: 25px 0;
            border-left: 5px solid #d35400;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
         .action-card strong {
            display: block;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .media-container {
            text-align: center;
            margin: 30px 0;
        }
        .media-container img {
            max-width: 100%; height: auto; border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Consistent shadow */
        }
        .caption {
            color: #555; /* Consistent color */
            margin-top: 10px; font-size: 14px;
            font-style: normal; /* Removed italic */
        }

        .question-item { /* Use question-box style */
            background-color: rgba(230, 126, 34, 0.07); /* Aligned bg */
            padding: 25px; border-radius: 6px;
            margin: 25px 0;
            border: 1px solid rgba(230, 126, 34, 0.2); /* Aligned border */
        }
        .question-text {
            color: #34495e; /* Darker blue heading */
            font-weight: 600; /* Bolder */
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        .question-text .required-star { /* Style for asterisk */
             color: #e74c3c;
             font-weight: bold;
             margin-left: 3px;
        }

         /* Unified class for all answer fields (Consistent) */
        .editable-answer {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 8px; /* Adjusted from 10px */
            margin-bottom: 10px; /* Adjusted from 5px */
            background-color: white;
            min-height: 45px; /* Default min height */
            line-height: 1.6;
            display: block;
            color: #333;
            font-size: 15px;
             transition: border-color 0.3s, box-shadow 0.3s;
        }
        textarea.editable-answer { min-height: 100px; } /* Specific textarea height */

        .editable-answer:focus { /* Consistent focus */
            outline: none;
            border-color: #e67e22;
            box-shadow: 0 0 0 3px rgba(230, 126, 34, 0.2);
        }
        .editable-answer::placeholder { /* Consistent placeholder */
             color: #aaa;
             opacity: 1;
        }

        /* Save/Delete Buttons (Consistent) */
        .save-btn, .delete-btn {
            color: white; border: none; padding: 8px 15px; /* Increased padding */
            border-radius: 4px; cursor: pointer; transition: all 0.3s ease;
            font-size: 14px; /* Increased size */ font-weight: 500;
        }
        .save-btn { background-color: #27ae60; margin-right: 8px; } /* Consistent green */
        .delete-btn { background-color: #e74c3c; } /* Consistent red */

        .save-btn:hover { background-color: #2ecc71; transform: translateY(-1px); }
        .delete-btn:hover { background-color: #c0392b; transform: translateY(-1px); }
        .save-btn:active, .delete-btn:active { transform: translateY(0); }

        .saved-message { /* Consistent */
            color: #27ae60; font-size: 13px; margin-left: 5px;
            display: none; font-weight: 500;
        }
         .saved-message.deleted { /* Style for delete message */
             color: #6c757d; /* Grey color for delete */
        }

        /* General table styles (Consistent) */
        table { width: 100%; border-collapse: collapse; margin: 25px 0; font-size: 14px; }
        table, th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background-color: #f2f2f2; font-weight: 600; color: #333; }

        /* Action Table specific styles */
        .action-table { /* Instruction Table */
            width: 100%; margin: 20px 0; background-color: #f8f9fa;
            border-radius: 6px; overflow: hidden; border: 1px solid #ddd;
        }
        .action-table th {
            background-color: #34495e; /* Darker Blue Header */
            color: white; text-align: center;
        }
        .action-table td { vertical-align: top; color: #333; } /* Default TD text color */

        /* Skill/Will Data Entry Table */
        .skill-will-table { /* Specific class for data table */
            width: 100%; border-collapse: collapse; margin: 25px 0; font-size: 14px;
        }
        .skill-will-table th {
             background-color: #e67e22; /* Orange Header */
             color: white;
             text-align: center;
        }
        .skill-will-table td {
             vertical-align: middle; /* Align vertically center */
             background-color: rgba(230, 126, 34, 0.05); /* Light orange row bg */
        }
        /* Styles for input/select within the skill/will table */
        .skill-will-table .editable-answer {
            width: auto; /* Allow natural width */
            min-width: 150px; margin: 5px 0; padding: 8px 10px; /* Adjusted */
            font-size: 14px; display: inline-block; vertical-align: middle;
            flex-grow: 1; color: #333; background-color: white; /* Ensure white bg */
            border: 1px solid #ccc;
        }
        .skill-will-table input.editable-answer::placeholder { color: #888; } /* Lighter placeholder */

        .table-input-group { /* Consistent */
             display: flex; align-items: center; gap: 10px; flex-wrap: wrap;
        }

        /* Button Container (Bottom Navigation) (Consistent) */
        .button-container {
            display: flex; justify-content: space-between; margin-top: 40px;
            gap: 20px; border-top: 1px solid #eee; padding-top: 25px;
        }
        .button { /* General style for nav buttons */
            text-decoration: none; padding: 12px 20px; color: white;
            border-radius: 4px; font-weight: 600; flex: 1; text-align: center;
            transition: all 0.3s ease; font-size: 15px; border: none; cursor: pointer;
        }
         /* Specific colors/styles */
        .button.back { background-color: #6c757d; } /* Grey back */
        .button#nextButton { background-color: #e67e22; } /* Orange next */

        .button:hover { transform: translateY(-1px); filter: brightness(110%); }
        .button:active { transform: translateY(0); filter: brightness(100%); }


        /* Warning Message (Bottom) (Consistent) */
        .warning-message {
            background-color: #fff8e1; border-left: 4px solid #ffc107;
            padding: 15px; margin: 20px 0; color: #333; display: none;
            font-size: 14px; line-height: 1.6; border-radius: 4px; font-weight: 500;
        }

        /* Required Field Style (Consistent) */
        .required-field {
            border: 2px solid #e74c3c !important;
            background-color: #fff2f1 !important;
             box-shadow: none !important; /* No extra shadow on error */
             /* Removed pulse animation for consistency */
        }

        /* Section specific styles (Consistent BG/Borders) */
        .model-section, .trust-section, .rapport-section, .informal-tips {
            padding: 20px; border-radius: 6px; margin: 25px 0;
            border-left-width: 5px; border-left-style: solid;
        }
        .model-section { background-color: rgba(52, 152, 219, 0.1); border-left-color: #3498db; }
        .trust-section { background-color: rgba(46, 204, 113, 0.1); border-left-color: #2ecc71; }
        .rapport-section { background-color: rgba(155, 89, 182, 0.1); border-left-color: #9b59b6; }
        .informal-tips { background-color: rgba(241, 196, 15, 0.1); border-left-color: #f1c40f; }

        /* GROW Model Grid */
        .grow-model { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0; }
        .grow-step { background-color: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.08); border-top: 4px solid #3498db; }
        .grow-step h4 { margin-top: 0; color: #3498db; }

        /* Skill/Will Matrix Grid */
        .skill-will-matrix { display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 10px; margin: 20px 0; }
        .matrix-quadrant { padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.08); }
        .matrix-quadrant h4 { margin-top: 0; }
        /* Colors match Skills page */
        .guide { background-color: rgba(52, 152, 219, 0.1); border-top: 4px solid #3498db; } /* Blue */
        .delegate { background-color: rgba(46, 204, 113, 0.1); border-top: 4px solid #2ecc71; } /* Green */
        .direct { background-color: rgba(231, 76, 60, 0.1); border-top: 4px solid #e74c3c; } /* Red */
        .excite { background-color: rgba(241, 196, 15, 0.1); border-top: 4px solid #f1c40f; } /* Yellow */

        /* Solution Model Steps */
        .solution-model { display: flex; flex-direction: column; gap: 15px; margin: 20px 0; }
        .solution-step { display: flex; align-items: flex-start; background-color: white; border-radius: 8px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.08); border-left: 4px solid #3498db; }
        .step-number { background-color: #3498db; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px; flex-shrink: 0; font-weight: bold; }

        /* Drawing Together Section (Consistent) */
        .drawing-together {
            display: flex; align-items: center; gap: 20px;
            background-color: rgba(155, 89, 182, 0.1); /* Purple tint */
            padding: 20px; border-radius: 6px; margin: 25px 0;
            border-left: 5px solid #9b59b6; /* Purple border */
        }
        .drawing-icon { font-size: 28px; color: #9b59b6; flex-shrink: 0; }

        .answer-buttons { /* Consistent */
            display: flex; gap: 8px; align-items: center; margin-top: 10px; /* Adjusted */
            flex-wrap: wrap;
        }

        /* Inline Error Message (Consistent) */
        .inline-error-message {
            color: #e74c3c; font-size: 13px; margin-left: 5px;
            display: none; font-weight: 500;
        }

         /* Modal Styles (Consistent) */
        .modal-overlay {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.6); z-index: 1000; justify-content: center;
            align-items: center; animation: modalFadeInBackground 0.3s ease-out;
        }
        @keyframes modalFadeInBackground { from { background: rgba(0,0,0,0); } to { background: rgba(0,0,0,0.6); } }
        .modal-content {
            background: white; padding: 30px 40px; border-radius: 8px;
            max-width: 450px; text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            position: relative; animation: modalSlideIn 0.3s ease-out;
        }
         @keyframes modalSlideIn { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        .modal-button {
            background-color: #27ae60; /* Consistent Green */
            color: white; border: none; padding: 12px 25px; border-radius: 5px;
            cursor: pointer; margin-top: 25px; font-weight: bold; transition: all 0.3s;
            font-size: 15px;
        }
        .modal-button:hover { background-color: #219653; transform: translateY(-2px); }
        .close-modal {
            position: absolute; top: 15px; right: 15px; background: none; border: none;
            font-size: 24px; cursor: pointer; color: #aaa; transition: color 0.3s;
        }
        .close-modal:hover { color: #555; }

        /* Required Star Helper */
         .required-star { color: #e74c3c; font-weight: bold; margin-left: 2px; }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
             h1 { font-size: 22px; padding: 15px; margin: 20px 15px; }
             h1 + p { font-size: 14px; margin: -10px 15px 20px; }
             .container { padding: 20px; margin: 0 15px 20px; }
             .user-bar { padding: 10px 15px; font-size: 13px; }
             .user-name { font-size: 13px; }
             .user-email { font-size: 11px; }
             .logout-button { padding: 7px 12px; font-size: 12px; }
             .nav-tab { padding: 10px 5px; }
             .nav-tab a { margin: 0 5px; padding: 7px 10px; font-size: 13px;}
             .section-title { font-size: 1.4em; margin: 25px 0 10px 0; }
             .highlight-section, .action-card, .question-item, .model-section, .trust-section, .rapport-section, .informal-tips, .drawing-together {
                 padding: 15px; margin: 20px 0;
             }
             .editable-answer { font-size: 14px; padding: 10px; }
             textarea.editable-answer { min-height: 80px; }
             .save-btn, .delete-btn { padding: 7px 13px; font-size: 13px; }
             .button-container { flex-direction: column; gap: 15px; padding-top: 20px; margin-top: 30px;}
             .button { font-size: 14px; padding: 12px 15px;}
             .grow-model { grid-template-columns: 1fr; }
             .skill-will-matrix { grid-template-columns: 1fr; }
             .modal-content { max-width: 90%; padding: 20px 25px; }
             .modal-button { padding: 10px 20px; font-size: 14px; }
             .close-modal { top: 10px; right: 10px; font-size: 20px; }
             .table-input-group { flex-direction: column; align-items: stretch; }
             .skill-will-table .editable-answer { width: 100%; display: block; }
             .answer-buttons { justify-content: flex-start;} /* Align buttons left on mobile */
             .warning-message { font-size: 13px; }
        }

    </style>
</head>
<body>
    <!-- User Info Bar -->
    <div class="user-bar">
        <div class="user-info">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="opacity: 0.8;">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <div class="user-details">
                <span class="user-name" id="userName">Welcome back</span>
                <span class="user-email" id="userEmail">user@example.com</span>
            </div>
        </div>
        <button class="logout-button" onclick="logout()">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            Logout
        </button>
    </div>

    <!-- Navigation Tabs -->
    <nav class="nav-tab">
        <a href="index.html">Home</a>
        <a href="article1.html">Article 1</a>
        <a href="coaching-skills.html">Coaching Skills</a>
        <a href="coaching-individuals.html" class="active">Coaching Individuals</a>
        <a href="coaching-team.html">Team Coaching</a>
        <a href="coaching-yourself.html">Self Coaching</a>
        <a href="action-plan.html">Action Plan</a> <!-- Assuming Action Plan is next -->
    </nav>

    <!-- Removed separate header, using H1 -->
    <h1>Coaching Individuals</h1>
    <p>Professional development through effective coaching techniques</p>

    <div class="container">
        <h2 class="section-title">The Power of Individual Coaching</h2>

        <div class="highlight-section">
            <p>Deep down, your team members likely already know the answers to their problems. As a coach, your job is to guide them toward this realization.</p>
        </div>

        <p>One-on-one coaching is a great way to provide this guidance. It's the most common form of coaching, and it's valuable in many ways. For example, it can help your team members to:</p>

        <ul style="margin-left: 25px; list-style: disc; margin-bottom: 15px;">
            <li>Identify career goals, and develop plans to achieve them</li>
            <li>Improve their time-management and organizational skills</li>
            <li>Find the right work-life balance</li>
            <li>Make better decisions</li>
            <li>Develop skills to work more effectively</li>
            <li>Reduce stress</li>
            <li>Build more productive work relationships</li>
            <li>Think positively</li>
        </ul>

        <p>In an individual coaching relationship, it's important that you are humble, and that you always respect the other person's opinions. Never assume that you have the "right" answer. Make suggestions, but think of yourself as a partner, not a teacher. Remember that most of the time, the solutions to whatever issues your team members have lie within themselves.</p>

        <p>In this chapter, we'll look at some useful models that you can use to frame your one-on-one coaching conversations. We'll also discuss how to build successful coaching relationships, and how you can use coaching techniques informally, as well as in structured sessions.</p>

        <div class="media-container">
            <img src="https://images.unsplash.com/photo-1542744173-8e7e53415bb0?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80"
                 alt="Professional coaching session with two individuals engaged in discussion"
                 loading="lazy">
            <p class="caption">Effective one-on-one coaching builds trust and facilitates personal growth</p>
        </div>

        <h2 class="section-title">2.1 Useful Coaching Models</h2>

        <p>You may feel a little daunted by the prospect of coaching another person. After all, if you're like most leaders, you probably haven't received any formal coaching training. So, how do you know what to do or say to guide your team member effectively?</p>

        <p>Fortunately, there are many established models, techniques and approaches that you can use to structure your coaching sessions.</p>

        <!-- GROW Model Section -->
        <div class="model-section"> <!-- Blue border/bg -->
            <h3>1. The GROW Model</h3>
            <p>The GROW Model is a simple, yet powerful, coaching tool. GROW stands for:</p>

            <div class="grow-model">
                <div class="grow-step">
                    <h4>Goal</h4>
                    <p>What does your team member want to achieve? Help them identify clear, specific objectives.</p>
                </div>
                <div class="grow-step">
                    <h4>Reality</h4>
                    <p>What is the current situation? Explore the facts and perceptions about where they are now.</p>
                </div>
                <div class="grow-step">
                    <h4>Options</h4>
                    <p>What could your team member do? Brainstorm possible approaches and strategies.</p>
                </div>
                <div class="grow-step">
                    <h4>Will</h4>
                    <p>What will your team member do? Commit to specific actions and establish accountability.</p>
                </div>
            </div>

            <h4>Using the GROW Model:</h4>
            <ol style="margin-left: 25px;">
                <li><strong>Establish a Goal:</strong> Identify what the coachee wants to accomplish.</li>
                <li><strong>Examine Reality:</strong> Explore the current situation honestly.</li>
                <li><strong>Explore Options:</strong> Brainstorm potential actions and strategies.</li>
                <li><strong>Establish Will (Plan):</strong> Commit to specific, actionable steps, discuss motivation, overcome obstacles, and set review dates.</li>
            </ol>
        </div>

        <!-- Skill/Will Matrix Section -->
        <div class="model-section"> <!-- Blue border/bg -->
            <h3>2. The Skill/Will Matrix</h3>
            <p>Your team members all have their own needs, personalities, skills and abilities. This means that you will need to tailor your approach to fit each individual.</p>

            <p>The Skill/Will Matrix, developed by coach and author Max Landsberg in 2003, can enable you to find the appropriate coaching style for every situation.</p>

            <div class="skill-will-matrix">
                <div class="matrix-quadrant guide"> <!-- Blue -->
                    <h4>Guide</h4>
                    <p>(High Will, Low Skill) Motivated but needs direction/training.</p>
                </div>
                <div class="matrix-quadrant delegate"> <!-- Green -->
                    <h4>Delegate</h4>
                    <p>(High Will, High Skill) Capable & motivated - give autonomy.</p>
                </div>
                <div class="matrix-quadrant direct"> <!-- Red -->
                    <h4>Direct</h4>
                    <p>(Low Will, Low Skill) Needs clear instructions & supervision.</p>
                </div>
                <div class="matrix-quadrant excite"> <!-- Yellow -->
                    <h4>Excite</h4>
                    <p>(Low Will, High Skill) Capable but needs motivation/inspiration.</p>
                </div>
            </div>

            <!-- Instruction Table -->
            <table class="action-table">
                 <thead>
                    <tr> <th colspan="2">ACTION: Create Your Coaching Map</th> </tr>
                    <tr> <td style="width: 30%; font-weight:bold;">Instructions</td> <td>List your team members and identify where they fall on the Skill/Will Matrix. Only map members you intend to coach.</td> </tr>
                 </thead>
            </table>

            <!-- Data Entry Table -->
            <table class="skill-will-table"> <!-- Changed class for specific styling -->
                <thead>
                    <tr> <!-- Orange header -->
                        <th>Name of Team Member</th>
                        <th>Coaching Map Quadrant</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Row 1 -->
                    <tr>
                        <td><input type="text" class="editable-answer" placeholder="Enter name (optional)" data-question="team-member1"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map1">
                                    <option value="">Select quadrant (if name entered)...</option>
                                    <option value="Guide">Guide</option>
                                    <option value="Delegate">Delegate</option>
                                    <option value="Direct">Direct</option>
                                    <option value="Excite">Excite</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team1')">Save Row</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team1')">Delete Row</button>
                                    <span class="saved-message" id="save-status-team1"></span>
                                    <span class="inline-error-message" id="error-team1"></span>
                                </div>
                             </div>
                        </td>
                    </tr>
                     <!-- Row 2 -->
                    <tr>
                        <td><input type="text" class="editable-answer" placeholder="Enter name (optional)" data-question="team-member2"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map2">
                                    <option value="">Select quadrant (if name entered)...</option>
                                    <option value="Guide">Guide</option>
                                    <option value="Delegate">Delegate</option>
                                    <option value="Direct">Direct</option>
                                    <option value="Excite">Excite</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team2')">Save Row</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team2')">Delete Row</button>
                                    <span class="saved-message" id="save-status-team2"></span>
                                    <span class="inline-error-message" id="error-team2"></span>
                                </div>
                             </div>
                        </td>
                    </tr>
                     <!-- Row 3 -->
                    <tr>
                        <td><input type="text" class="editable-answer" placeholder="Enter name (optional)" data-question="team-member3"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map3">
                                    <option value="">Select quadrant (if name entered)...</option>
                                    <option value="Guide">Guide</option>
                                    <option value="Delegate">Delegate</option>
                                    <option value="Direct">Direct</option>
                                    <option value="Excite">Excite</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team3')">Save Row</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team3')">Delete Row</button>
                                    <span class="saved-message" id="save-status-team3"></span>
                                    <span class="inline-error-message" id="error-team3"></span>
                                </div>
                             </div>
                        </td>
                    </tr>
                     <!-- Row 4 -->
                    <tr>
                        <td><input type="text" class="editable-answer" placeholder="Enter name (optional)" data-question="team-member4"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map4">
                                    <option value="">Select quadrant (if name entered)...</option>
                                    <option value="Guide">Guide</option>
                                    <option value="Delegate">Delegate</option>
                                    <option value="Direct">Direct</option>
                                    <option value="Excite">Excite</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team4')">Save Row</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team4')">Delete Row</button>
                                    <span class="saved-message" id="save-status-team4"></span>
                                    <span class="inline-error-message" id="error-team4"></span>
                                </div>
                             </div>
                        </td>
                    </tr>
                     <!-- Row 5 -->
                    <tr>
                        <td><input type="text" class="editable-answer" placeholder="Enter name (optional)" data-question="team-member5"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map5">
                                    <option value="">Select quadrant (if name entered)...</option>
                                    <option value="Guide">Guide</option>
                                    <option value="Delegate">Delegate</option>
                                    <option value="Direct">Direct</option>
                                    <option value="Excite">Excite</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team5')">Save Row</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team5')">Delete Row</button>
                                    <span class="saved-message" id="save-status-team5"></span>
                                    <span class="inline-error-message" id="error-team5"></span>
                                </div>
                             </div>
                        </td>
                    </tr>
                     <!-- Row 6 -->
                    <tr>
                        <td><input type="text" class="editable-answer" placeholder="Enter name (optional)" data-question="team-member6"></td>
                        <td>
                            <div class="table-input-group">
                                <select class="editable-answer" data-question="coaching-map6">
                                    <option value="">Select quadrant (if name entered)...</option>
                                    <option value="Guide">Guide</option>
                                    <option value="Delegate">Delegate</option>
                                    <option value="Direct">Direct</option>
                                    <option value="Excite">Excite</option>
                                </select>
                                <div class="answer-buttons">
                                    <button class="save-btn" onclick="saveCombinedAnswer('team6')">Save Row</button>
                                    <button class="delete-btn" onclick="deleteCombinedAnswer('team6')">Delete Row</button>
                                    <span class="saved-message" id="save-status-team6"></span>
                                    <span class="inline-error-message" id="error-team6"></span>
                                </div>
                             </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <p style="font-size: 0.9em; color: #555;">Note: Saving a row requires both Name and Quadrant to be filled. Empty rows will not be saved.</p>
        </div>

        <!-- Solution-Focused Coaching Section -->
        <div class="model-section"> <!-- Blue border/bg -->
            <h3>3. Solution-Focused Coaching</h3>
            <p>The Solution-Focused Coaching approach helps you to identify what your team member wants, and how he can achieve it. Your aim is not to examine why a specific problem is occurring, but to find a solution. This helps you to avoid dwelling on the negatives. It's a simple and positive way to coach someone.</p>

            <div class="solution-model">
                <div class="solution-step">
                    <div class="step-number">1</div>
                    <div><h4>Identify Goal/Solution:</h4><p>Define a clear, specific outcome.</p></div>
                </div>
                <div class="solution-step">
                    <div class="step-number">2</div>
                    <div><h4>Create Plan:</h4><p>Develop actionable steps together.</p></div>
                </div>
                <div class="solution-step">
                    <div class="step-number">3</div>
                    <div><h4>Take Action & Monitor:</h4><p>Implement, track results, adjust.</p></div>
                </div>
                <div class="solution-step">
                    <div class="step-number">4</div>
                    <div><h4>Change What Isn't Working:</h4><p>Adapt based on effectiveness.</p></div>
                </div>
            </div>

            <!-- Action Box for Reflection -->
             <div class="action-card">
                <strong>ACTION: Reflect on Solution-Focused Coaching</strong><br>
                 Think about a team member or situation where this approach could be beneficial. Answer the questions below.
            </div>

            <div class="question-item"> <!-- Consistent question box style -->
                <div class="question-text">1. What specific goal could you help a team member identify using this approach?<span class="required-star">*</span></div>
                <textarea class="editable-answer required-answer" data-question="solution-goal" placeholder="e.g., Improve presentation delivery confidence, Reduce time spent on email admin..."></textarea>
                <div class="answer-buttons">
                    <button class="save-btn" onclick="saveAnswer('solution-goal')">Save</button>
                    <button class="delete-btn" onclick="deleteAnswer('solution-goal')">Delete</button>
                    <span class="saved-message" id="save-status-solution-goal"></span>
                    <span class="inline-error-message" id="error-solution-goal"></span>
                </div>
            </div>

            <div class="question-item">
                <div class="question-text">2. How would you help them create an effective action plan (Step 2)?<span class="required-star">*</span></div>
                <textarea class="editable-answer required-answer" data-question="solution-plan" placeholder="e.g., Break goal into smaller steps, identify resources needed, set mini-deadlines..."></textarea>
                <div class="answer-buttons">
                    <button class="save-btn" onclick="saveAnswer('solution-plan')">Save</button>
                    <button class="delete-btn" onclick="deleteAnswer('solution-plan')">Delete</button>
                    <span class="saved-message" id="save-status-solution-plan"></span>
                    <span class="inline-error-message" id="error-solution-plan"></span>
                </div>
            </div>

        </div>

        <!-- Building Trust Section -->
        <h2 class="section-title">2.2 Setting up a Coaching Relationship</h2>
        <p>Trust and rapport are two of the most important aspects of a successful coaching relationship. Without them, your team member is unlikely to share his thoughts and feelings with you.</p>
        <div class="trust-section"> <!-- Green border/bg -->
            <h3>Building Trust</h3>
            <p>Key ways to develop trust:</p>
            <ul style="margin-left: 25px; list-style: disc;">
                <li><strong>Demonstrate Credibility:</strong> Show confidence, competence, and honesty. Admit when you don't know something but commit to finding answers together.</li>
                <li><strong>Show Reliability:</strong> Be dependable. Keep commitments, be punctual, and respect expectations.</li>
                <li><strong>Foster Comfort:</strong> Create a safe space. Share appropriately about yourself (values, experiences) to build connection.</li>
                <li><strong>Show You Care:</strong> Demonstrate genuine interest in the coachee's well-being and development, beyond just work tasks. Be patient and committed.</li>
            </ul>
        </div>

        <!-- Building Rapport Section -->
        <div class="rapport-section"> <!-- Purple border/bg -->
            <h3>Building Rapport</h3>
            <p>Building rapport involves finding common ground. Explore these levels:</p>
            <ol style="margin-left: 25px;">
                <li><strong>Environment:</strong> Shared context (work, location, etc.).</li>
                <li><strong>Behavior:</strong> Similar activities or interests.</li>
                <li><strong>Capability:</strong> Shared skills or abilities.</li>
                <li><strong>Beliefs:</strong> Common values or principles.</li>
                <li><strong>Identity:</strong> Shared sense of self or group affiliation.</li>
                <li><strong>Spirit:</strong> Similar outlook or higher purpose (use cautiously).</li>
            </ol>
        </div>

        <!-- Informal Coaching Section -->
        <h2 class="section-title">2.3 Informal Coaching</h2>
        <p>You don't have to wait for a structured session to use your coaching skills. Good coaches engage with their team members daily or weekly.</p>
        <div class="informal-tips"> <!-- Yellow border/bg -->
            <h3>Tips for Informal Coaching:</h3>
            <ul style="margin-left: 25px; list-style: disc;">
                <li><strong>Monitor Workloads:</strong> Offer support during busy times or when priorities seem unclear.</li>
                <li><strong>Be Aware of Moods:</strong> Notice changes in behavior or body language as potential coaching moments.</li>
                <li><strong>Ask Permission:</strong> Check if it's a good time before launching into a coaching conversation.</li>
                <li><strong>Ask, Don't Tell:</strong> Focus on questions and listening, rather than giving advice or instructions. Avoid "I think...".</li>
                <li><strong>Use Informal Settings:</strong> Coffee breaks or casual chats can be effective, maintaining professionalism while being relaxed.</li>
            </ul>
        </div>

        <div class="media-container">
            <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80"
                 alt="Casual coaching conversation in a workplace setting"
                 loading="lazy">
            <p class="caption">Informal coaching often happens spontaneously in the workplace</p>
        </div>

        <!-- Action Box for Reflection -->
        <div class="action-card">
             <strong>ACTION: Practice Informal Coaching</strong><br>
             Identify an opportunity for informal coaching this week. Afterward, reflect on the experience using the questions below.
        </div>

        <!-- Informal Coaching Questions -->
        <div class="question-item">
            <div class="question-text">1. How did you initiate the informal coaching conversation?<span class="required-star">*</span></div>
            <textarea class="editable-answer required-answer" data-question="informal-initiate" placeholder="e.g., 'Noticed you seemed stuck on X, got a minute?' or 'How are things going with Y?'..."></textarea>
            <div class="answer-buttons">
                <button class="save-btn" onclick="saveAnswer('informal-initiate')">Save</button>
                <button class="delete-btn" onclick="deleteAnswer('informal-initiate')">Delete</button>
                <span class="saved-message" id="save-status-informal-initiate"></span>
                <span class="inline-error-message" id="error-informal-initiate"></span>
            </div>
        </div>

        <div class="question-item">
            <div class="question-text">2. What clues suggested the person might benefit from the session?<span class="required-star">*</span></div>
            <textarea class="editable-answer required-answer" data-question="informal-benefit" placeholder="e.g., Body language (slumped shoulders), verbal cues (frustration), repeated mistakes..."></textarea>
            <div class="answer-buttons">
                <button class="save-btn" onclick="saveAnswer('informal-benefit')">Save</button>
                <button class="delete-btn" onclick="deleteAnswer('informal-benefit')">Delete</button>
                <span class="saved-message" id="save-status-informal-benefit"></span>
                <span class="inline-error-message" id="error-informal-benefit"></span>
            </div>
        </div>

        <div class="question-item">
            <div class="question-text">3. Was your team member receptive? How did you gauge this?<span class="required-star">*</span></div>
            <textarea class="editable-answer required-answer" data-question="informal-receptive" placeholder="e.g., Yes, they opened up; No, seemed distracted; Initially hesitant but then engaged..."></textarea>
            <div class="answer-buttons">
                <button class="save-btn" onclick="saveAnswer('informal-receptive')">Save</button>
                <button class="delete-btn" onclick="deleteAnswer('informal-receptive')">Delete</button>
                <span class="saved-message" id="save-status-informal-receptive"></span>
                 <span class="inline-error-message" id="error-informal-receptive"></span>
            </div>
        </div>
         <p style="font-size: 0.9em; color: #555;"><span class="required-star">*</span> Required field to proceed.</p>

        <!-- Drawing Together Section -->
        <h2 class="section-title">2.4 Drawing This Together</h2>
        <div class="drawing-together"> <!-- Purple border/bg -->
            <div class="drawing-icon">✓</div>
            <div>
                <p>In this chapter, we discussed how to coach an individual member of your team. We outlined several models (GROW, Skill/Will, Solution-Focused) to guide your approach, and found out how to get your coaching relationships off to a great start by building trust and rapport. We also explored the value of informal coaching opportunities.</p>
                <p>The next chapter focuses on how to coach a team. We'll look at how group coaching works, and examine several models and processes that you can use to do it.</p>
            </div>
        </div>

        <!-- General Warning Message (for Next Button click) -->
        <div class="warning-message" id="generalWarningMessage">
            <strong>Action Required:</strong> Please complete all required answers (marked with <span class="required-star">*</span>) before proceeding.
        </div>

        <!-- Navigation Buttons -->
        <div class="button-container">
            <a href="coaching-skills.html" class="button back">← Back to Coaching Skills</a>
            <button type="button" class="button" id="nextButton">Next: Team Coaching →</button>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal-overlay">
        <div class="modal-content">
            <button class="close-modal" onclick="closeModal()">×</button>
            <h3 style="color: #27ae60;">Section Complete!</h3> <!-- Green heading -->
            <p>All required answers for this section have been saved.</p>
            <p>You can now proceed to the next section.</p>
            <button class="modal-button" onclick="redirectToNextPage()">CONTINUE TO TEAM COACHING</button>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const formspreeEndpoint = 'https://formspree.io/f/xzzeqvea'; // YOUR Formspree Endpoint
        const localStorageKey = 'allUserAnswers_coachingIndividuals'; // Specific key for THIS page
        const currentUserKey = 'currentUser'; // Key for storing the whole user object

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = getCurrentUser();
            if (!currentUser || !currentUser.email) {
                console.error("User not logged in or email missing. Redirecting...");
                window.location.href = `login.html?redirect=${encodeURIComponent(window.location.pathname)}`;
                return;
            }
            displayUserInfo(currentUser);
            loadUserAnswers(currentUser.email);
            setupEventListeners(currentUser.email);
            highlightActiveNav(); // Highlight current nav tab
            addRequiredStars(); // Add visual indicators for required fields
        });

        // --- User Info & Authentication ---
        function getCurrentUser() {
            try {
                const userDataString = localStorage.getItem(currentUserKey);
                return userDataString ? JSON.parse(userDataString) : null;
            } catch (error) {
                console.error("Error parsing user data:", error);
                return null;
            }
        }

        function displayUserInfo(user) {
            document.getElementById('userName').textContent = `Welcome, ${user.name || 'User'}`;
            document.getElementById('userEmail').textContent = user.email;
        }

        function logout() {
            localStorage.removeItem('loggedIn');
            localStorage.removeItem(currentUserKey);
            // Consider clearing page-specific answers on logout? Decide policy.
            // localStorage.removeItem(localStorageKey);
            window.location.href = 'login.html';
        }

         function highlightActiveNav() {
             const currentPath = window.location.pathname.split('/').pop() || 'index.html';
             const navLinks = document.querySelectorAll('.nav-tab a');
             navLinks.forEach(link => {
                 const linkPath = link.getAttribute('href');
                 if (linkPath === currentPath) {
                     link.classList.add('active');
                 } else {
                     link.classList.remove('active');
                 }
             });
         }

         function addRequiredStars() {
              document.querySelectorAll('.required-answer').forEach(field => {
                   const questionItem = field.closest('.question-item');
                   if (questionItem) {
                       const questionText = questionItem.querySelector('.question-text');
                       if (questionText && !questionText.querySelector('.required-star')) {
                           questionText.insertAdjacentHTML('beforeend', '<span class="required-star">*</span>');
                       }
                   }
               });
               // Hide redundant paragraph notes if stars are added dynamically
               const notes = document.querySelectorAll('p:has(.required-star)');
               notes.forEach(note => note.style.display = 'none');
         }


        // --- Answer Handling (Local Storage) ---
        function loadUserAnswers(userEmail) {
            if (!userEmail) return;
            let allAnswers = {};
            try {
                 const storedData = localStorage.getItem(localStorageKey);
                 if (storedData) { allAnswers = JSON.parse(storedData) || {}; }
            } catch(e) { console.error("Error parsing stored answers:", e); }

            const userPageAnswers = allAnswers[userEmail] || {};

            // Load answers for textareas
            document.querySelectorAll('textarea.editable-answer').forEach(field => {
                 const questionId = field.getAttribute('data-question');
                 loadFieldState(field, questionId, userPageAnswers);
            });

             // Load answers for Skill/Will matrix rows
             for (let i = 1; i <= 6; i++) {
                 const nameField = document.querySelector(`input[data-question="team-member${i}"]`);
                 const mapField = document.querySelector(`select[data-question="coaching-map${i}"]`);
                 const statusId = `save-status-team${i}`;
                 const statusElement = document.getElementById(statusId);

                 if (nameField) loadFieldState(nameField, nameField.dataset.question, userPageAnswers, false); // Don't show status for name field alone
                 if (mapField) loadFieldState(mapField, mapField.dataset.question, userPageAnswers, false); // Don't show status for map field alone

                 // Show combined saved status only if BOTH fields have saved, non-empty values
                 const savedName = userPageAnswers[nameField?.dataset.question]?.trim();
                 const savedMap = userPageAnswers[mapField?.dataset.question]?.trim();
                 if (statusElement) {
                     if (savedName && savedMap) {
                         statusElement.textContent = '✓ Saved';
                         statusElement.style.display = 'inline';
                          // Auto-hide saved message
                         setTimeout(() => { if (statusElement.textContent === '✓ Saved') statusElement.style.display = 'none'; }, 3000);
                     } else {
                         statusElement.style.display = 'none';
                     }
                 }
             }
        }

        // Helper function to load state for a single field
        function loadFieldState(field, questionId, userAnswers, showStatus = true) {
            const statusId = `save-status-${questionId}`; // Assumes individual status ID for textareas
            const statusElement = document.getElementById(statusId);

            if (userAnswers[questionId] !== undefined) {
                field.value = userAnswers[questionId];
                field.classList.remove('required-field');
                if (showStatus && userAnswers[questionId].trim() !== '' && statusElement) {
                     statusElement.textContent = '✓ Saved';
                     statusElement.style.display = 'inline';
                      // Auto-hide saved message
                     setTimeout(() => { if (statusElement.textContent === '✓ Saved') statusElement.style.display = 'none'; }, 3000);
                } else if (showStatus && statusElement) {
                    statusElement.style.display = 'none';
                }
            } else {
                field.value = ''; // Reset if no answer saved
                 if (field.tagName === 'SELECT') field.selectedIndex = 0; // Reset select to placeholder
                 if (showStatus && statusElement) statusElement.style.display = 'none';
            }
        }


        function saveAnswerToStorage(userEmail, questionId, answer) {
            if (!userEmail) return false;
             let allAnswers = {};
             try {
                 const storedData = localStorage.getItem(localStorageKey);
                 if (storedData) { allAnswers = JSON.parse(storedData) || {}; }
             } catch(e) { console.error("Error parsing answers before save:", e); allAnswers = {}; } // Reset on error

            if (!allAnswers[userEmail]) { allAnswers[userEmail] = {}; }
            allAnswers[userEmail][questionId] = answer;
            try {
                localStorage.setItem(localStorageKey, JSON.stringify(allAnswers));
                console.log(`Saved locally: ${questionId}`);
                return true;
            } catch (error) {
                 console.error("Error saving to localStorage:", error);
                 alert("Could not save answer. Browser storage might be full.");
                 return false;
            }
        }

        function deleteAnswerFromStorage(userEmail, questionId) {
            if (!userEmail) return false;
             let allAnswers = {};
              try {
                 const storedData = localStorage.getItem(localStorageKey);
                 if (storedData) { allAnswers = JSON.parse(storedData) || {}; }
                 else { return false; } // Nothing to delete
             } catch(e) { console.error("Error parsing answers before delete:", e); return false; }

             let updated = false;
             if (allAnswers[userEmail] && allAnswers[userEmail][questionId] !== undefined) {
                 delete allAnswers[userEmail][questionId];
                 updated = true;
                 if (Object.keys(allAnswers[userEmail]).length === 0) { delete allAnswers[userEmail]; }
             }

             if(updated) {
                try {
                    localStorage.setItem(localStorageKey, JSON.stringify(allAnswers));
                    console.log(`Deleted locally: ${questionId}`);
                    return true;
                } catch (error) { console.error("Error saving after delete:", error); return false; }
             }
             return false;
        }

        // --- Event Listeners Setup ---
        function setupEventListeners(userEmail) {
            // Input listeners to clear validation errors
             document.querySelectorAll('.required-answer, .skill-will-table .editable-answer').forEach(field => {
                 const eventType = (field.tagName === 'SELECT') ? 'change' : 'input';
                 field.addEventListener(eventType, function() {
                      const questionId = this.getAttribute('data-question');
                      let isCombinedRow = questionId?.startsWith('team-member') || questionId?.startsWith('coaching-map');

                      // Clear individual field error style
                       if (this.value.trim() !== '' || (this.tagName === 'SELECT' && this.value !== '')) {
                           this.classList.remove('required-field');
                       }
                       // Clear individual message if it exists
                       const individualErrorId = `error-${questionId}`;
                       if(document.getElementById(individualErrorId)) hideError(individualErrorId);


                      // If it's part of a combined row, check if the combined error can be cleared
                       if (isCombinedRow) {
                            const rowNum = questionId.slice(-1);
                            const nameField = document.querySelector(`[data-question="team-member${rowNum}"]`);
                            const mapField = document.querySelector(`[data-question="coaching-map${rowNum}"]`);
                            const combinedErrorId = `error-team${rowNum}`;

                            // If BOTH fields now have a value, hide the combined error message
                            if (nameField?.value.trim() !== '' && mapField?.value.trim() !== '') {
                                hideError(combinedErrorId);
                                // Also ensure individual fields are not marked red
                                nameField.classList.remove('required-field');
                                mapField.classList.remove('required-field');
                            }
                        }
                 });
             });

            // Next button validation & modal trigger
            const nextButton = document.getElementById('nextButton');
            if (nextButton) {
                nextButton.addEventListener('click', function(e) {
                    if (!validateAllAnswers(true)) { // Pass true to show errors on click
                        e.preventDefault();
                        showGeneralWarningMessage();
                    } else {
                        e.preventDefault(); // Prevent default even on success to show modal
                        showSuccessModal();
                    }
                });
            }
        }

        // --- UI Feedback & Validation ---
        function validateAllAnswers(showErrors = false) {
            let allValid = true;
            let firstInvalidField = null;

            // Check required textareas
            document.querySelectorAll('textarea.required-answer').forEach(field => {
                const questionId = field.getAttribute('data-question');
                const errorId = `error-${questionId}`;
                 if (field.value.trim() === '') {
                    allValid = false;
                    if (!firstInvalidField) firstInvalidField = field;
                    if (showErrors) {
                        field.classList.add('required-field');
                        showError(errorId, null, 'Please enter an answer.'); // Show error message without focusing field here
                    }
                } else {
                    field.classList.remove('required-field');
                    hideError(errorId);
                }
            });

            // Check Skill/Will Matrix rows
             for (let i = 1; i <= 6; i++) {
                const nameField = document.querySelector(`[data-question="team-member${i}"]`);
                const mapField = document.querySelector(`[data-question="coaching-map${i}"]`);
                const errorId = `error-team${i}`;

                if (nameField && mapField) {
                    const nameValue = nameField.value.trim();
                    const mapValue = mapField.value.trim();

                    // Reset styles first
                    nameField.classList.remove('required-field');
                    mapField.classList.remove('required-field');
                    hideError(errorId);

                    // *** Validation Logic: If a name is entered, a map MUST be selected ***
                    if (nameValue && !mapValue) {
                         allValid = false;
                         if (!firstInvalidField) firstInvalidField = mapField;
                         if (showErrors) {
                             mapField.classList.add('required-field'); // Highlight the select
                             showError(errorId, null, 'Quadrant required if name is entered.'); // Show combined error
                         }
                    }
                    // Optional: uncomment to require name if map is selected
                    /* else if (!nameValue && mapValue) {
                         allValid = false;
                          if (!firstInvalidField) firstInvalidField = nameField;
                         if (showErrors) {
                             nameField.classList.add('required-field'); // Highlight the name field
                             showError(errorId, null, 'Name required if quadrant is selected.');
                         }
                    } */
                }
            }

             // Scroll to and focus the first invalid field if validation fails and errors are shown
             if (!allValid && showErrors && firstInvalidField) {
                 firstInvalidField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                 setTimeout(() => {
                     try { firstInvalidField.focus({ preventScroll: true }); } catch (e) {}
                 }, 400); // Delay focus
             }

            return allValid;
        }

        function showGeneralWarningMessage() {
            const warningElement = document.getElementById('generalWarningMessage');
            if (!warningElement) return;
            // Reset animation if already visible
            warningElement.style.animation = 'none';
            void warningElement.offsetWidth; // Trigger reflow

            warningElement.style.display = 'block';
            warningElement.style.animation = 'slideDownFadeIn 0.4s ease-out'; // Use consistent animation name

            clearTimeout(warningElement.timer); // Clear previous timeout
            warningElement.timer = setTimeout(() => {
                warningElement.style.animation = 'fadeOutUp 0.5s ease-out forwards'; // Use consistent animation name
                 setTimeout(() => {
                      if (warningElement.style.animationName === 'fadeOutUp') {
                           warningElement.style.display = 'none';
                           warningElement.style.animation = '';
                      }
                 }, 500);
            }, 4000);
        }


        function showSaveStatus(statusId, message = '✓ Saved') {
             const statusElement = document.getElementById(statusId);
             if (!statusElement) return;
             statusElement.textContent = message;
             statusElement.classList.remove('deleted');
             statusElement.style.color = '#27ae60'; // Consistent green
             if (message.includes('Deleted') || message.includes('deleted')) {
                 statusElement.classList.add('deleted');
                  statusElement.style.color = '#6c757d'; // Consistent grey for deleted
             }
             statusElement.style.display = 'inline-block';
             clearTimeout(statusElement.timer);
             statusElement.timer = setTimeout(() => {
                 statusElement.style.display = 'none';
             }, 3000); // Consistent 3 seconds
        }

        function showError(errorId, fieldToFocus, message = 'Required field.') { // Accept field to focus optionally
             const errorElement = document.getElementById(errorId);
             if (!errorElement) return;
             errorElement.textContent = message;
             errorElement.style.color = '#e74c3c'; // Consistent red
             errorElement.style.display = 'inline-block';
             // Don't focus here, let validateAllAnswers handle focus on the *first* error
        }


        function hideError(errorId) { // Hide error message
             const errorElement = document.getElementById(errorId);
             if (errorElement) errorElement.style.display = 'none';
        }

        function hideMessages(statusId, errorId, field) { // Hide both status and error, remove class
             hideError(errorId);
             const statusElement = document.getElementById(statusId);
             if (statusElement) statusElement.style.display = 'none';
             if (field) field.classList.remove('required-field');
        }

        // --- Actions (Save, Delete for Textareas) ---
        function saveAnswer(questionId) {
             const currentUser = getCurrentUser();
             if (!currentUser?.email) return;

             const field = document.querySelector(`textarea[data-question="${questionId}"], input[data-question="${questionId}"], select[data-question="${questionId}"]`); // Find any editable answer field
             if (!field) { console.error(`Field not found for ${questionId}`); return; }

             const statusId = `save-status-${questionId}`;
             const errorId = `error-${questionId}`;
             const answer = field.value; // Get raw value
             const trimmedAnswer = answer.trim();
             const isRequired = field.classList.contains('required-answer');

             // Clear previous messages/styles for this field
             hideMessages(statusId, errorId, field);

             // Validate if required
             if (isRequired && !trimmedAnswer) {
                field.classList.add('required-field');
                showError(errorId, null, 'Please enter an answer.'); // Don't focus here
                return;
             }

             // Save and Submit
             if (saveAnswerToStorage(currentUser.email, questionId, answer)) {
                 submitToFormspree(currentUser.email, questionId, answer);
                 showSaveStatus(statusId);
                 field.classList.remove('required-field'); // Ensure cleaned up
                 hideError(errorId); // Ensure error is hidden
             }
        }

        function deleteAnswer(questionId) {
            const currentUser = getCurrentUser();
            if (!currentUser?.email) return;

            const field = document.querySelector(`textarea[data-question="${questionId}"], input[data-question="${questionId}"], select[data-question="${questionId}"]`);
             if (!field) { console.error(`Field not found for ${questionId}`); return; }

             const statusId = `save-status-${questionId}`;
             const errorId = `error-${questionId}`;

             // Clear UI
             hideMessages(statusId, errorId, field);
             field.value = '';
              if (field.tagName === 'SELECT') field.selectedIndex = 0; // Reset select

             // Delete from storage and show status
             if (deleteAnswerFromStorage(currentUser.email, questionId)) {
                  showSaveStatus(statusId, '✓ Deleted');
             }
        }

        // --- Actions (Save, Delete for Combined Skill/Will Rows) ---
         function saveCombinedAnswer(rowIdentifier) {
             const currentUser = getCurrentUser();
             if (!currentUser?.email) return;

             const rowNum = rowIdentifier.slice(-1);
             const nameQuestionId = `team-member${rowNum}`;
             const mapQuestionId = `coaching-map${rowNum}`;
             const statusId = `save-status-${rowIdentifier}`;
             const errorId = `error-${rowIdentifier}`;

             const nameField = document.querySelector(`[data-question="${nameQuestionId}"]`);
             const mapField = document.querySelector(`[data-question="${mapQuestionId}"]`);

             if (!nameField || !mapField) { console.error(`Fields not found for ${rowIdentifier}`); return; }

             const nameValue = nameField.value; // Raw value
             const mapValue = mapField.value; // Raw value
             const trimmedName = nameValue.trim();
             const trimmedMap = mapValue.trim();

             // Clear previous messages/styles for the row
             hideMessages(statusId, errorId, null);
             nameField.classList.remove('required-field');
             mapField.classList.remove('required-field');

             // Validate: If name entered, map must be selected. Saving requires *both* to be non-empty.
             let rowValid = true;
             let focusField = null; // Track field to potentially focus

             if (trimmedName && !trimmedMap) { // Name but no Map -> Error
                 rowValid = false;
                 mapField.classList.add('required-field');
                 showError(errorId, null, 'Quadrant required if name is entered.');
                 if (!focusField) focusField = mapField;
             } else if (!trimmedName && trimmedMap) { // Map but no Name -> Optional Error (uncomment if needed)
                 /*
                 rowValid = false;
                 nameField.classList.add('required-field');
                 showError(errorId, null, 'Name required if quadrant is selected.');
                  if (!focusField) focusField = nameField;
                 */
                  // Current: Allow saving Map without Name (but maybe doesn't make sense?)
                  // If we allow this, we skip the `!rowValid` check below for this case.
                  // Let's enforce Name if Map is selected for better data integrity
                  rowValid = false;
                  nameField.classList.add('required-field');
                  showError(errorId, null, 'Name required if quadrant is selected.');
                  if (!focusField) focusField = nameField;

             } else if (!trimmedName && !trimmedMap) {
                 // Row is empty - allow saving as "empty", don't show error, don't submit
                 console.log(`Row ${rowNum} is empty, saving empty state.`);
                 // Ensure data is cleared in storage
                 deleteAnswerFromStorage(currentUser.email, nameQuestionId);
                 deleteAnswerFromStorage(currentUser.email, mapQuestionId);
                 showSaveStatus(statusId, '✓ Row cleared'); // Indicate empty save
                 return; // Exit save function for empty row
             }

             // If validation failed for any reason above
             if (!rowValid) {
                 if (focusField) { // Focus the first field that failed
                     setTimeout(() => { try { focusField.focus({ preventScroll: true }); } catch(e){} }, 100);
                 }
                 return; // Stop save
             }


             // Save both pieces of data
             let saved = saveAnswerToStorage(currentUser.email, nameQuestionId, nameValue);
             saved = saveAnswerToStorage(currentUser.email, mapQuestionId, mapValue) && saved;

             if (saved) {
                 // Submit both pieces individually to Formspree
                 submitToFormspree(currentUser.email, nameQuestionId, nameValue);
                 submitToFormspree(currentUser.email, mapQuestionId, mapValue);
                 showSaveStatus(statusId);
                 nameField.classList.remove('required-field'); // Ensure cleanup
                 mapField.classList.remove('required-field');
                 hideError(errorId);
             }
         }

         function deleteCombinedAnswer(rowIdentifier) {
             const currentUser = getCurrentUser();
             if (!currentUser?.email) return;

             const rowNum = rowIdentifier.slice(-1);
             const nameQuestionId = `team-member${rowNum}`;
             const mapQuestionId = `coaching-map${rowNum}`;
             const statusId = `save-status-${rowIdentifier}`;
             const errorId = `error-${rowIdentifier}`;

             const nameField = document.querySelector(`[data-question="${nameQuestionId}"]`);
             const mapField = document.querySelector(`[data-question="${mapQuestionId}"]`);

             if (!nameField || !mapField) return;

             // Clear UI
             hideMessages(statusId, errorId, null);
             nameField.classList.remove('required-field');
             mapField.classList.remove('required-field');
             nameField.value = '';
             mapField.value = ''; // Reset select

             // Delete from storage
             let deleted1 = deleteAnswerFromStorage(currentUser.email, nameQuestionId);
             let deleted2 = deleteAnswerFromStorage(currentUser.email, mapQuestionId);

             if (deleted1 || deleted2) { // Show status if anything was deleted
                showSaveStatus(statusId, '✓ Deleted');
             }
         }

        // --- Formspree Submission ---
        function submitToFormspree(userEmail, questionId, answer) {
            if (!formspreeEndpoint) { console.warn("Formspree endpoint not configured."); return; }
            if (!userEmail) { console.warn("No user email for Formspree."); return; }
            // Submit even empty strings if they were explicitly saved, but not undefined/null
            if (answer === undefined || answer === null) return;

            const formData = new FormData();
            formData.append('email', userEmail);
            formData.append('page', document.title); // Use full page title
            formData.append('page_key', 'coachingIndividuals'); // Add a key identifier
            formData.append('question_id', questionId);
            formData.append('answer_text', answer);

            const currentUser = getCurrentUser();
            if (currentUser?.name) formData.append('user_name', currentUser.name);

            // Add Question Context if possible
             const fieldElement = document.querySelector(`[data-question="${questionId}"]`);
             if (fieldElement) {
                 const questionItem = fieldElement.closest('.question-item');
                 let questionText = `Q-ID: ${questionId}`; // Fallback
                 if (questionItem) {
                     const textDiv = questionItem.querySelector('.question-text');
                     if (textDiv) questionText = textDiv.textContent.replace('*','').trim();
                 } else if (fieldElement.closest('.skill-will-table')) {
                     if (questionId.startsWith('team-member')) questionText = `Skill/Will Table - Team Member Name (Row ${questionId.slice(-1)})`;
                     else questionText = `Skill/Will Table - Quadrant (Row ${questionId.slice(-1)})`;
                 }
                 formData.append('question_context', questionText);
             }


            fetch(formspreeEndpoint, {
                method: 'POST', body: formData, headers: { 'Accept': 'application/json' }
            })
            .then(response => {
                if (response.ok) { console.log(`Formspree: ${questionId} submitted.`); }
                else { response.json().then(data => console.error(`Formspree error (${questionId}):`, data.errors ? data.errors.map(e => e.message).join(', ') : `Status ${response.status}`)).catch(() => console.error(`Formspree non-JSON error (${questionId}). Status: ${response.status}`)); }
            })
            .catch(error => console.error(`Network error submitting (${questionId}):`, error));
        }

        // --- Modal Handling ---
        function showSuccessModal() {
             const modal = document.getElementById('successModal');
             if(modal) modal.style.display = 'flex';
        }

        function closeModal() {
            const modal = document.getElementById('successModal');
            if(modal) modal.style.display = 'none';
        }

        function redirectToNextPage() {
            // *** IMPORTANT: Update this to the correct filename for the next page ***
            window.location.href = 'coaching-team.html';
        }

    </script>
</body>
</html>
